<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>FAQ | THREDDS Documentation</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="www.unidata.ucar.edufeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> THREDDS Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">THREDDS Source<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/Unidata/THREDDS" target="_blank">netCDF-Java and TDS Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/Rosetta" target="_blank">Rosetta Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/siphon" target="_blank">Siphon Github Repo</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="tds_tutorial_index.html">THREDDS Data Server Tutorial</a></li>
                        
                        
                        
                        <li><a href="netcdf_java_tutorial_index.html">netCDF-Java Tutorial</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.unidata.ucar.edu/software/rosetta/docs/" target="_blank">Rosetta</a></li>
                        
                        
                        
                        <li><a href="https://siphon.readthedocs.io/en/latest/#" target="_blank">Siphon</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li><a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:support-thredds@unidta.ucar.edu?subject=THREDDS Documentation Feedback f eedback&body=I have some feedback about the FAQ page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a><li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="FAQ">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          







<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">TDS Tutorial 5.0.0</li>
    
    
    
        
    
    <li>
        <a href="#">Getting Started with the TDS</a>
        <ul>
            
            
            
            <li><a href="tds_tutorial_index.html">TDS Overview</a></li>
            
            
            
            
            
            
            <li><a href="install_java_tomcat.html">Installing Java and Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_dir_structure_qt.html">Tomcat Directory Structure</a></li>
            
            
            
            
            
            
            <li><a href="running_tomcat.html">Running Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_log_files.html">Tomcat Log Files</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_configuration_files.html">Tomcat Config Files</a></li>
            
            
            
            
            
            
            <li><a href="deploying_the_tds.html">Deploying the TDS</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_manager_app.html">Tomcat Manager Application</a></li>
            
            
            
            
            
            
            <li><a href="where_to_go_from_here.html">Where to go from here</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Client Catalogs</a>
        <ul>
            
            
            
            <li><a href="basic_client_catalog.html">Basic Client Catalog Primer</a></li>
            
            
            
            
            
            
            <li><a href="nested_datasets.html">Nested Datasets</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_metadata.html">Client Catalog Metadata</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_references.html">Catalog References</a></li>
            
            
            
            
            
            
            <li><a href="compound_service_elements.html">Compound service elements</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_xml_validation.html">XML Validation</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_via_toolsUI.html">Client Catalogs in ToolsUI</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">TDS Configuration</a>
        <ul>
            
            
            
            <li><a href="tds_content_directory.html">TDS Content Directory</a></li>
            
            
            
            
            
            
            <li><a href="default_config_catalog.html">Default TDS Configuration Catalog</a></li>
            
            
            
            
            
            
            <li><a href="basic_config_catalog.html">Basics of Configuration Catalogs</a></li>
            
            
            
            
            
            
            <li><a href="basic_tds_configuration.html">Basic TDS Configuration</a></li>
            
            
            
            
            
            
            <li><a href="adding_ogc_iso_services.html">Adding OGC / ISO Services</a></li>
            
            
            
            
            
            
            <li><a href="adding_ncss.html">Adding the netCDF Subset Service</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Monitoring and Debugging</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">TDS Monitoring and Debugging</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Tomcat and TDS Logs</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using the TdsMonitor Tool</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">3rd Party Tools</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">netCDF Markup Language (NcML)</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Basic NcML Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using NcML in the TDS</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Basic NcML Examples</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Feature Collections</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collections</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collection Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Files in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Tables in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Forecast Model Run Collections (FMRC)</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">FMRC Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Metadata</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">THREDDS Metadata</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">ISO Metadata Generation</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Production Servers</a>
        <ul>
            
            
            
            <li><a href="production_server_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Troubleshooting Problems</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Performance Tips</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Upgrading to 5.0</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Installation Checklist</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">FAQ</a>
        <ul>
            
            
            
            <li class="active"><a href="tds_faq.html">FAQ</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Reference Guide</a>
        <ul>
            
            
            
            <li><a href="tds_config_ref.html">TDS Config (threddsConfig.xml)</a></li>
            
            
            
            
            
            
            <li><a href="viewers_ref.html">Viewers</a></li>
            
            
            
            
            
            
            <li><a href="dataset_source_plugin.html">Data Source Plugins</a></li>
            
            
            
            
            
            
            <li><a href="wcs_ref.html">WCS Reference</a></li>
            
            
            
            
            
            
            <li><a href="wms_ref.html">WMS Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Remote Management Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Netcdf Subset Service Reference</a></li>
            
            
            
            
            
            
            <li><a href="tds_doc_guide.html">netCDF-Java and TDS Doc Guide</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">FAQ</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    

  <h2 id="general">General</h2>

<h3 id="i-have-a-strange-problem-and-i-need-help-figuring-out-whats-going-on">I have a strange problem and I need help figuring out whats going on!</h3>

<p>Here is what we need from you in order to deal with hard problems:</p>

<ol>
  <li>Run the latest stable release.
Sorry, we don’t have the resources to keep older versions running, so we need to deal with just the latest code.</li>
  <li>Get a clean set of logs that capture the problem:
    <ol>
      <li>Stop the tomcat server.</li>
      <li>Install the latest release if needed.</li>
      <li>Remove all files from {tomcat}/logs and <code class="highlighter-rouge">${tds.content.root.path}</code>/thredds/logs</li>
      <li>Restart the server</li>
      <li>Make the problem happen</li>
      <li>Zip up everything in {tomcat}/logs and <code class="highlighter-rouge">${tds.content.root.path}/thredds/logs</code>.</li>
      <li>Send the logs and a detailed description of what you do to make the problem happen, and what the problem looks like.</li>
      <li>If it took a while to get the problem to happen, note what time it happened so that we can correlate with the logs.</li>
    </ol>
  </li>
</ol>

<h3 id="i-made-changes-to-my-catalog-and-restarted-tomcat-but-nothing-changes">I made changes to my catalog and restarted tomcat but nothing changes.</h3>

<ol>
  <li>look in <code class="highlighter-rouge">catalina.out</code> for a message that tomcat did not shut down:
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">BindException</span><span class="o">:</span> <span class="n">Address</span> <span class="n">already</span> <span class="n">in</span> <span class="nl">use:</span><span class="mi">8080</span>
</code></pre>
    </div>
  </li>
  <li>make sure tomcat really gets stopped:
    <ol>
      <li><code class="highlighter-rouge">ps -ef | grep java</code> to find the process id</li>
      <li><code class="highlighter-rouge">kill &lt;pid&gt;</code> or <code class="highlighter-rouge">kill -9 &lt;pid&gt;</code></li>
      <li><code class="highlighter-rouge">ps -ef | grep java</code> to verify that the process goes away.</li>
    </ol>
  </li>
  <li>Restart tomcat:
    <ol>
      <li><code class="highlighter-rouge">sh ./startup.sh</code></li>
      <li>Check <code class="highlighter-rouge">catalina.out</code> that tomcat started correctly</li>
      <li><code class="highlighter-rouge">ps -ef | grep java</code> to verify that there is a new tomcat process.</li>
    </ol>
  </li>
</ol>

<h3 id="im-building-my-own-maven-project-and-want-to-use-your-jar-files-where-is-the-unidata-repository">I’m building my own maven project and want to use your jar files. Where is the Unidata Repository?</h3>

<p>In order to configure your maven project correctly, you need to edit your pom.xml file to reflect the location of Unidata’s repository.
To do this, you need to add the following pom snippet to your pom.xml file:</p>
<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;repositories&gt;</span>
  <span class="nt">&lt;repository&gt;</span>
    <span class="nt">&lt;id&gt;</span>unidata-releases<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;name&gt;</span>UNIDATA Releases<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;url&gt;</span>https://artifacts.unidata.ucar.edu/content/repositories/unidata-releases/<span class="nt">&lt;/url&gt;</span>
  <span class="nt">&lt;/repository&gt;</span>
<span class="nt">&lt;/repositories&gt;</span>
</code></pre>
</div>
<p>Alternatively, you can configure your settings.xml file to reflect the repository location.
Information on doing either is located here:</p>

<p><a href="http://maven.apache.org/pom.html#Repositories" target="_blank">Maven Repository information</a></p>

<p>and here:</p>

<p><a href="http://maven.apache.org/settings.html" target="_blank">Maven Settings information</a></p>

<h3 id="im-submitting-a-paper-for-publication-and-want-to-include-a-citation-for-the-tds-what-reference-should-i-use">I’m submitting a paper for publication and want to include a citation for the TDS. What reference should I use?</h3>

<p>The following can be used as a citation:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   Unidata, (year): THREDDS Data Server (TDS) version tds_version [software].
   Boulder, CO: UCAR/Unidata. (http://doi.org/10.5065/D6N014KG)
</code></pre>
</div>

<p>where year is the year in which the work being described was done and tds_version is the version of the TDS used.
For example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   Unidata, (2017): THREDDS Data Server (TDS) version 4.6.8 [software].
   Boulder, CO: UCAR/Unidata. (http://doi.org/10.5065/D6N014KG)
</code></pre>
</div>

<h2 id="catalogs">Catalogs</h2>

<h3 id="how-do-i-construct-the-urls-i-find-in-a-thredds-catalog">How do I construct the URLs I find in a THREDDS Catalog?</h3>

<p>Heres the general idea in the tutorial and the catalog spec docs.
If you are using the CDM library, you can call</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">InvAccess</span><span class="o">.</span><span class="na">getUrlPath</span><span class="o">()</span>
</code></pre>
</div>

<h3 id="how-do-i-eliminate-the-extra-dataset-when-using-a-catalog-reference">How do I eliminate the extra dataset when using a Catalog Reference?</h3>

<p>Make the name of the catalogRef the same as the “top” dataset in the referenced catalog.
In the following example the name is New Point Data”.</p>

<p>In the referencing catalog:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;catalogRef</span> <span class="na">xlink:href=</span><span class="s">"idd/newPointObs.xml"</span> <span class="na">xlink:title=</span><span class="s">"New Point Data"</span> <span class="na">name=</span><span class="s">""</span> <span class="nt">/&gt;</span>
</code></pre>
</div>

<p>In the referenced catalog:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;catalog</span> <span class="na">xmlns=</span><span class="s">"http://www.unidata.ucar.edu/namespaces/thredds/InvCatalog/v1.0"</span>
 <span class="na">xmlns:xlink=</span><span class="s">"http://www.w3.org/1999/xlink"</span> <span class="na">name=</span><span class="s">"THREDDS-IDD OPeNDAP Data Server - New Station Data"</span>
 <span class="na">version=</span><span class="s">"1.0.3"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"ncdods"</span> <span class="na">serviceType=</span><span class="s">"OPENDAP"</span> <span class="na">base=</span><span class="s">"/thredds/dodsC/"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;dataset</span> <span class="na">name=</span><span class="s">"New Point Data"</span><span class="nt">&gt;</span>
    ...
  <span class="nt">&lt;/dataset&gt;</span>
<span class="nt">&lt;/catalog&gt;</span>
</code></pre>
</div>

<h3 id="how-do-i-provide-an-external-service-one-that-is-not-provided-by-the-tds">How do I provide an external service, one that is not provided by the TDS?</h3>

<p>Make up your own service element, with an absolute URL for its base, in the configuration catalog.
For example, suppose you want to use the THREDDS OPeNDAP server, and an external WMS server:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" ?&gt;</span>  
<span class="nt">&lt;catalog</span> <span class="na">xmlns=</span><span class="s">"http://www.unidata.ucar.edu/namespaces/thredds/InvCatalog/v1.0"</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"both"</span> <span class="na">serviceType=</span><span class="s">"compound"</span> <span class="na">base=</span><span class="s">""</span><span class="nt">&gt;</span>
   <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"ncdods"</span> <span class="na">serviceType=</span><span class="s">"OPENDAP"</span> <span class="na">base=</span><span class="s">"/thredds/dodsC/"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"extWMS"</span> <span class="na">serviceType=</span><span class="s">"WMS"</span> <span class="na">base=</span><span class="s">"http://myserver:8080/wms"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/service&gt;</span>

  <span class="nt">&lt;dataset</span> <span class="na">name=</span><span class="s">"SAGE III Ozone 2006-10-31"</span> <span class="na">serviceName=</span><span class="s">"both"</span> <span class="na">urlPath=</span><span class="s">"sage/20061031.nc"</span> <span class="na">ID=</span><span class="s">"20061031.nc"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/catalog&gt;</span>
</code></pre>
</div>

<p>The problem is communicating the correct URL to your external WMS server.</p>

<h2 id="tds">TDS</h2>

<h3 id="how-do-i-keep-client-requests-from-overwhelming-my-server">How do I keep client requests from overwhelming my server?</h3>

<p>There is currently no per-client resource throttle, unfortunately, but we are aware of the need for that.
Any given request is single-threaded, so can’t hog too many resources.
One can limit the size of opendap responses, which tends to be the main problem on some servers.
See the OPeNDAP section of the threddsConfig.xml page for details.</p>

<h3 id="can-aggregations-of-many-files-cause-too-many-files-open-problems">Can aggregations of many files cause “too many files open” problems?</h3>

<p>Union type aggregations will open all the files in the aggregation at once.
The other types (joinNew, joinExisting) only open one file at a time, and then close it, so these can’t cause “too many file” problems.</p>

<p>If you have “too many open files” errors and you are not using large Union aggregations, then either theres a file leak (which we would like to know about), or you have your file cache limit set too high relative to your OS file handle limit.</p>

<p>To debug file leaks:</p>

<ol>
  <li>Check number of open files with <code class="highlighter-rouge">ulimit -a</code>.</li>
  <li>Restart Tomcat to close open files.</li>
  <li>Monitor open files with <code class="highlighter-rouge">/usr/proc/bin/pfiles [Tomcat Process ID]</code></li>
  <li>Recreate the problem with minimal number of steps so we can reproduce, then send pfiles output to support.</li>
</ol>

<h3 id="what-do-the-non-http-status-codes-in-the-threddsservletlog-files-mean">What do the non-HTTP status codes in the threddsServlet.log files mean?</h3>

<p>The <em>Request Completed</em> messages in the threddsServlet.log files contain several fields including a status code, the HTTP status code returned in a completed response.
If a request is forwarded to another internal service, a <em>1000 (Forwarded)</em> or <em>1001 (Going Away)</em></p>

<div class="highlighter-rouge"><pre class="highlight"><code>2009-06-17T13:25:54.451 -0600 [     28949][      11] INFO
  - thredds.server.catalogservice.LocalCatalogServiceController
  - handlePublicDocumentRequest(): Request Completed - 1001 - -1 - 32
</code></pre>
</div>

<h3 id="im-seeing-the-error-inconsistent-array-length-read-538976288--1668244581-when-i-open-the-dataset-in-the-idv-why">I’m seeing the error <em>Inconsistent array length read: 538976288 != 1668244581</em> when I open the dataset in the IDV. Why?</h3>

<p>The error <em>Inconsistent array length read</em> only tells you that there was an error on the server in the middle of responding to an OPeNDAP request.
You then must look in the <code class="highlighter-rouge">threddsServlet.log</code> and find the error to know why.</p>

<p>###: Why am I getting lots of <code class="highlighter-rouge">java.util.prefs.BackingStoreException warning</code> messages?</p>

<p>If you allow and use the TDS WMS service, you may be seeing warning messages in your Tomcat <code class="highlighter-rouge">catalina.out</code> log file that look something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>May 25, 2010 6:28:22 PM java.util.prefs.FileSystemPreferences syncWorld
WARNING: Couldn't flush system prefs: java.util.prefs.BackingStoreException: /etc/.java/.systemPrefs/org create failed.
</code></pre>
</div>

<p>You can get rid of these messages by setting the <code class="highlighter-rouge">java.util.prefs.systemRoot</code> system property to a location that is writable by the user that Tomcat runs under.</p>

<p>Here is what we do on our servers:</p>

<p>Create a directory at <code class="highlighter-rouge">${tds.content.root.path}/thredds/javaUtilPrefs/.systemPrefs</code>, e.g.,</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> <span class="k">${</span><span class="nv">tds</span><span class="p">.content.root.path</span><span class="k">}</span>/thredds
mkdir javaUtilPrefs
mkdir javaUtilPrefs/.systemPrefs
mkdir javaUtilPrefs/.userPrefs
</code></pre>
</div>

<p>Make sure that the <code class="highlighter-rouge">.systemPrefs</code> and <code class="highlighter-rouge">.userPrefs</code> directories are writable by the user under which Tomcat runs
Add the following to <code class="highlighter-rouge">JAVA_OPTS</code> in the <code class="highlighter-rouge">${tomcat_home}/bin/setenv.sh</code> file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>-Djava.util.prefs.systemRoot=${tds.content.root.path}/thredds/javaUtilPrefs -Djava.util.prefs.userRoot=${tds.content.root.path}/thredds/javaUtilPrefs
</code></pre>
</div>

<p>If you are interested in more details of the problem, here are two useful links:</p>

<p>Sun bug <a href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4751177" target="_blank">#4751177</a> (“Preferences storage placed unavailable to non-root users”)
<a href="http://allaboutbalance.com/articles/disableprefs/" target="_blank">Disabling Sun’s Java 1.4.x Preferences Subsystem</a></p>

<p>We have this TDS issue in our bug tracking system and plan to address it.</p>

<h3 id="my-tds-server-is-behind-a-proxy-server-why-do-some-tds-generated-urls-point-to-my-tds-server-instead-of-my-proxy-server">My TDS server is behind a proxy server. Why do some TDS generated URLs point to my TDS server instead of my proxy server?</h3>

<p>Most TDS generated URLs are relative to the server (e.g., <code class="highlighter-rouge">/thredds/dodsC/</code>) or relative to the the current document’s base URL.
There are only a few places where it is necessary to generate absolute URLs.
In those cases, the TDS uses information from the incoming HTTP request to construct the generated URLs.
It is up to the proxy to send the correct information to the proxied server so the request information will be correct.</p>

<p>For more information, see our web page on <a href="updateme">running Tomcat behind a proxy server</a>.
It contains links to Tomcat documentation on both <code class="highlighter-rouge">mod_proxy</code> and <code class="highlighter-rouge">mod_jk</code> as well as some user contributed documentation on setting up <code class="highlighter-rouge">mod_proxy</code>.</p>

<h3 id="i-have-modified-my-configuration-of-a-joinexisting-aggregation-dataset-but-nothing-has-changed">I have modified my configuration of a <code class="highlighter-rouge">JoinExisting</code> Aggregation dataset, but nothing has changed.</h3>

<p>The files and coordinates in a JoinExisting Aggregations are cached, and in some circumstances won’t get updated.
The default location for the cache is <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/agg/</code> unless you change it in the threddsConfig.xml file.
Go to that directory, there will be files with the name of the cached dataset(s).
Delete the file for the dataset that needs updating and restart Tomcat.</p>

<h3 id="what-happened-to-the-long-list-of-crss-in-my-wms-getcapabilities-documents">What happened to the long list of CRSs in my WMS GetCapabilities documents?</h3>

<p>In TDS 4.1, each WMS <code class="highlighter-rouge">GetCapabilities</code> document listed 100s of available CRS.
This made for very large GetCapabilities documents.
As of TDS 4.2, this list is limited to a select few CRSs.
We hope to make this list configurable in a future release.</p>

<p>In the mean time if you need a CRS that isn’t listed, try specifying it in the <code class="highlighter-rouge">GetMap</code> request.
The underlying library that handles CRS (Geotoolkit) still supports a large number of CRS and the TDS WMS should still support any of those CRS when requested.</p>

<h3 id="why-are-tds-web-forms-not-working">Why are TDS web forms not working?</h3>

<p>Look in <code class="highlighter-rouge">${tomcat_home}/logs/localhost.logs</code> for error messages like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>SEVERE: Servlet.service() for servlet GridSubsetService threw exception
    javax.xml.transform.TransformerFactoryConfigurationError: Provider net.sf.saxon.TransformerFactoryImpl not found
</code></pre>
</div>

<p>If you find these, the likely problem is that another webapp running in the same Tomcat container has set the XSLT parser with javax.xml.transform.TransformerFactory, which is global for the JVM.
The above example shows that the Saxon parser has been set, but is not being found by the TDS.
We saw this happening with the <em>OOSTethys</em> webapp.</p>

<p>The solution is to move the other webapp to its own Tomcat instance, or to move the required jar (eg saxon.jar) into Tomcat’s lib directory, where it is available to all webapps.
TDS does very simple XSLT to create its web forms, so its likely that it can work with any decent XSLT library.
By default it uses the JDK’s built-in XSLT library.</p>

<h3 id="what-does-the-tds-do-at-startup-to-read-the-configuration-catalogs-what-gets-cached-does-it-have-a-way-to-know-a-referenced-catalog-is-unchanged-when-do-referenced-catalogs-get-scanned">What does the TDS do at startup to read the configuration catalogs? What gets cached? Does it have a way to know a referenced catalog is unchanged? When do referenced catalogs get scanned?</h3>

<p>The TDS reads in all the config catalogs at startup.
It caches all of them, and uses the “expires” attribute on the catalog to decide if/when it needs to re-read a catalog.
It must read all catalogs, including catalogRefs, because it has to know what the possible dataset URLs are, and there is no contract that a client has to read a catalog before accessing the dataset.</p>

<h3 id="how-do-i-change-how-the-tds-logs">How do I change how the TDS logs?</h3>

<p>When the TDS is deployed for the first time, the contents of thredds.war will be “exploded” (i.e. extracted) to <code class="highlighter-rouge">${tomcat_home}/webapps/thredds</code>.
To change how the TDS logs, you’ll need to modify <code class="highlighter-rouge">${tomcat_home}/webapps/thredds/WEB-INF/classes/log4j2.xml</code>, which is a <em>Log4j 2</em> configuration file.</p>

<p>For example, suppose that instead of overwriting server startup messages in <code class="highlighter-rouge">${tds.content.root.path}/thredds/logs/serverStartup.log</code> from a previous run with new ones (the default behavior), you want to create a new log file for each startup.
In that case, you’d change:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;File</span> <span class="na">name=</span><span class="s">"serverStartupAppender"</span> <span class="na">fileName=</span><span class="s">"${tds.log.dir}/serverStartup.log"</span> <span class="na">append=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">"%d{yyyy-MM-dd'T'HH:mm:ss.SSSZ} [%10r][%8X{ID}] %-5p %c: %m%n"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/File&gt;</span>
</code></pre>
</div>

<p>to something like:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;RollingFile</span> <span class="na">name=</span><span class="s">"serverStartupAppender"</span> <span class="na">fileName=</span><span class="s">"${tds.log.dir}/serverStartup.log"</span>
      <span class="na">filePattern=</span><span class="s">"${tds.log.dir}/serverStartup.%d{yyyy-MM-dd}_%i.log"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">"%d{yyyy-MM-dd'T'HH:mm:ss.SSSZ} [%10r][%8X{ID}] %-5p %c: %m%n"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Policies&gt;</span>
    <span class="nt">&lt;OnStartupTriggeringPolicy</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/Policies&gt;</span>
<span class="nt">&lt;/RollingFile&gt;</span>
</code></pre>
</div>

<p>Be aware that if you install a new <code class="highlighter-rouge">thredds.war</code> to <code class="highlighter-rouge">${tomcat_home}/webapps</code>, the exploded directory—including all changes you made to <code class="highlighter-rouge">log4j2.xml</code> will be removed and the webapp will be redeployed from the new <code class="highlighter-rouge">thredds.war</code>. We suggest you copy <code class="highlighter-rouge">log4j2.xml</code> to a different location for the deployment and then copy it back over afterwards.</p>

<h2 id="caching">Caching</h2>

<h3 id="we-use-compressed-netcdf-files-and-the-very-first-access-to-them-are-quite-slow-although-subsequent-accesses-are-much-faster-then-become-slow-again-after-a-while-i-can-see-that-tds-uncompress-these-files-to-the-cdm-cache-directory-but-then-they-must-get-deleted-is-there-a-way-to-keep-them-in-the-cache-permanently">We use compressed netcdf files and the very first access to them are quite slow, although subsequent accesses are much faster, then become slow again after a while. I can see that TDS uncompress these files to the cdm cache directory, but then they must get deleted. Is there a way to keep them in the cache permanently?</h3>

<p>Essentially this is a tradeoff between storage space and the time to decompress.
We assume you don’t want to store the files uncompressed, so you have to pay the price of that.
To control how these files are cached, see CDM library Disk cache.
We would suggest that you use:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;DiskCache&gt;</span>
  <span class="nt">&lt;alwaysUse&gt;</span>true<span class="nt">&lt;/alwaysUse&gt;</span>
  <span class="nt">&lt;scour&gt;</span>1 hour<span class="nt">&lt;/scour&gt;</span>
  <span class="nt">&lt;maxSize&gt;</span>10 Gb<span class="nt">&lt;/maxSize&gt;</span>
<span class="nt">&lt;/DiskCache&gt;</span>
</code></pre>
</div>

<p>and choose <code class="highlighter-rouge">maxSize</code> carefully.
The trick is to make <code class="highlighter-rouge">maxSize</code> big enough to keep the <em>working set</em> uncompressed, i.e. if there is a relatively small <em>hot</em> set of files that get accessed a lot, you want to give enough cache space to keep them uncompressed in the cache.
Monitor the cache directory closely to see what files stay uncompressed, and how old they are, and modify <code class="highlighter-rouge">maxSize</code> as needed.</p>

<h3 id="since-i-upgraded-my-joinexisting-aggregation-is-now-very-slow-it-used-to-be-fast">Since I upgraded, my <code class="highlighter-rouge">joinExisting</code> aggregation is now very slow. It used to be fast!</h3>

<p><code class="highlighter-rouge">JoinExisting</code> aggregations need to open each file and extract the coordinates the first time the aggregation is accessed.
The information is cached (by default) in <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/agg</code>, so subsequent reads will be much faster.</p>

<p>A change to the default behavior of <code class="highlighter-rouge">DiskCache2</code> may cause a need to re-read the files.
The <code class="highlighter-rouge">4.3</code> default was to put all cache files into a single directory, but <code class="highlighter-rouge">4.6</code> default makes nested directories, because having thousands of files in a single directory is Considered Harmful.
If you need to, you can control that behavior in <code class="highlighter-rouge">threddsConfig.xml</code>, but better is to pay the price and redo the cache with nested directories.</p>

<p>Note that to get everything in the <code class="highlighter-rouge">joinExisting</code> cache ahead of time, you just need to make a request for the aggregation coordinate (usually time) values.
You could do it with an OPeNDAP request, or just open the file as a Grid (eg <code class="highlighter-rouge">WMS</code>, <code class="highlighter-rouge">WCS</code>, <code class="highlighter-rouge">NCSS</code>, from <code class="highlighter-rouge">ToolsUI</code>, <code class="highlighter-rouge">IDV</code>, etc) which will automatically request all coordinates.
A script to do so is also easy enough, using <code class="highlighter-rouge">wget</code> or <code class="highlighter-rouge">python</code> or whatever you like.</p>

<p>Upgrading to a new version is a good time to clear out your caches, if you are installing on top of your old TDS.
Just go to your cache directory (default is <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache</code>), and delete the entire directory, or if you have the inclination, go and selectively delete old stuff (but then you have to think harder).
Then trigger a repopulation as above.</p>

<h2 id="tds-install-errors">TDS Install Errors</h2>

<h3 id="error---tdscontextinit-content-directory-does-not-exist-and-could-not-be-created">ERROR - TdsContext.init(): Content directory does not exist and could not be created</h3>

<p>The TDS needs to create the directory <code class="highlighter-rouge">${tds.content.root.path}/thredds</code> but it does not have permission.
Make sure <code class="highlighter-rouge">${tds.content.root.path}</code> is owned and writable by the tomcat user.</p>

<h3 id="on-starting-up-tds-i-get-the-error-severe-error-listenerstart-and-severe-context-thredds-startup-failed-due-to-previous-errors-and-tds-wont-start">On starting up TDS, I get the error “SEVERE: Error listenerStart” and “SEVERE: Context [/thredds] startup failed due to previous errors”, and TDS wont start.</h3>

<p>Startup output looks something like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>1)
log4j:WARN No appenders could be found for logger (org.apache.commons.digester.Digester.sax).
log4j:WARN Please initialize the log4j system properly.

2)
INFO: HTMLManager: start: Starting web application at '/thredds'
TdsConfigContextListener.contextInitialized(): start.


3)
Jul 11, 2011 2:22:12 PM org.apache.catalina.core.StandardContext start SEVERE: Error listenerStart

Jul 11, 2011 2:22:12 PM org.apache.catalina.core.StandardContext start SEVERE: Context [/thredds] startup failed due to previous errors
</code></pre>
</div>

<p>where:</p>

<ol>
  <li>Harmless log4j warnings. Someday we’ll figure out how to get rid of it.</li>
  <li>Various initialization info messages</li>
  <li>This is the problem, but it doesn’t actually contain enough information to know whats going on.
It usually means theres an error in how you set up Tomcat.</li>
</ol>

<h3 id="what-does-this-error-mean-log4jerror-attempted-to-append-to-closed-appender-named-foobar">What does this error mean: <code class="highlighter-rouge">log4j:ERROR Attempted to append to closed appender named [foobar]</code>?</h3>

<p>The <code class="highlighter-rouge">log4j.xml</code> file has 2 loggers with the same name, that uses the appender <em>foobar</em>.
You must delete one of the loggers.</p>

<h2 id="tomcat">Tomcat</h2>

<h3 id="im-getting-the-error-javalangoutofmemoryerror-java-heap-space-whats-up">Im getting the error “java.lang.OutOfMemoryError: Java heap space”. Whats up?</h3>

<p>If you reload the <code class="highlighter-rouge">thredds.war</code> webapp enough times without restarting Tomcat, you will eventually run into <code class="highlighter-rouge">java.lang.OutOfMemoryError</code>.
This is a known bug in JDK/Tomcat. The only thing to do is to stop and restart Tomcat.</p>

<p>The other possibility is that you haven’t given the TDS enough heap space.\
The default heap size is quite small, so you need to always set this JVM Option (for example, in <code class="highlighter-rouge">setenv.sh</code>):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>-Xmx4g
</code></pre>
</div>

<h3 id="im-getting-the-error-javalangoutofmemoryerror-permgen-space-whats-up">Im getting the error “java.lang.OutOfMemoryError: PermGen space”. Whats up?</h3>

<p>The good news is that this problem goes away with Java 8, and we recommend that you switch to Java 8 NOW.</p>

<p>Before Java 8, if you reload the <code class="highlighter-rouge">thredds.war</code> webapp enough times without restarting Tomcat, you will eventually run into <code class="highlighter-rouge">java.lang.OutOfMemoryError: PermGen space</code>.
This is a known bug in JDK/Tomcat.
The only thing to do is to stop and restart Tomcat.</p>

<p>You can increase PermGen using this JVM Option (for example, in <code class="highlighter-rouge">setenv.sh</code>):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>-XX:MaxPermSize=256m
</code></pre>
</div>

<p>In Java 6 and 7, the default is <code class="highlighter-rouge">64m</code>.
However, with enough redeploys , you will eventually run out of PermGen space no matter what your <code class="highlighter-rouge">MaxPermSize</code> setting is.
We have gotten into the habit of restarting Tomcat on our production server whenever we redeploy.
Lots of redeploys only happen on our test server.</p>

<p>Resources:</p>

<p><a href="http://blogs.sun.com/fkieviet/entry/classloader_leaks_the_dreaded_java" target="_blank">“Classloader leaks”</a> (sun blog) (2006-10-16)
<a href="http://my.opera.com/karmazilla/blog/2007/09/29/return-of-the-permgen" target="_blank">“Return of the PermGen”</a> (2007-09-29)
<a href="http://my.opera.com/karmazilla/blog/2007/03/15/permgen-strikes-back" target="_blank">“PermGen Strikes Back”</a> (2007-03-15)
<a href="http://my.opera.com/karmazilla/blog/2007/03/13/good-riddance-permgen-outofmemoryerror" target="_blank">“Good Riddance PermGen OutOfMemoryError”</a> (2007-03-13)</p>

<h3 id="during-shutdown-im-getting-messages-about-threads-threadlocal-having-to-be-shut-down-to-prevent-memory-leaks-whats-up">During shutdown I’m getting messages about threads (ThreadLocal) having to be shut down to prevent memory leaks. Whats up?</h3>

<p>Tomcat memory leak detection code started logging these messages as of Tomcat 6.0.24.
From various posts (see Spring Forum: <a href="http://forum.springsource.org/showpost.php?p=282738&amp;postcount=3" target="_blank">“ThreadLocal forcefully removed”</a> comment #3) it appears that these messages are not a problem but instead a matter of Tomcat finding these objects before they get garbage collected.</p>

<p>Here are a number of related links:</p>

<ul>
  <li>Spring Forum: <a href="http://forum.springsource.org/showthread.php?p=282738#post282738" target="_blank">“ThreadLocal forcefully removed”</a>. Comment #3 provides an answer to the post.</li>
  <li><a href="http://wiki.apache.org/tomcat/MemoryLeakProtection" target="_blank">Tomcat Memory Leak Prevention</a> page (in particular, see the <a href="http://wiki.apache.org/tomcat/MemoryLeakProtection#customThreadLocal" target="_blank">“Custom ThreadLocal”</a> section)</li>
  <li>A Tomcat 7 issue on <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=%2049159" target="_blank">“Improving ThreadLocal memory leak clean-up”</a></li>
</ul>

<p>NOTE: We will monitor the status of this Tomcat issue.
For now, we do not consider this a TDS bug and will not be working to fix this issue in TDS.</p>

<h3 id="who-is-accessing-my-server">Who is accessing my server?</h3>

<p>When you examine the TDS access logs, you can see who is accessing the TDS by IP address. Use <code class="highlighter-rouge">nslookup &lt;ip address&gt;</code> to find out the host name.</p>

<h3 id="how-can-i-control-whether-i-want-web-crawlers-to-access-my-server">How can I control whether I want Web crawlers to access my server?</h3>

<p>Well-behaved web crawlers are supposed to look for a robots.txt file on the server and follow its instructions.
To set up a robots.txt file that excludes web crawlers from crawling your server, <a href="http://www.unidata.ucar.edu/software/thredds/current/tds/reference/Performance.html#robots" target="_blank">follow these directions</a>.</p>

<h3 id="how-can-i-prevent-someone-from-accessing-my-server">How can I prevent someone from accessing my server?</h3>

<p>If your server is being overwhelmed by requests from a particular user/computer, it is best to exclude them using their IP address rather than their hostname (this avoids having to perform a DNS lookup for each request).
To do so, edit the <code class="highlighter-rouge">${tomcat_home}/conf/server.xml</code> file and find the <code class="highlighter-rouge">&lt;localhost&gt;</code> Host element.
Add a RemoteAddrValve Valve element as follows:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Host</span> <span class="na">name=</span><span class="s">"localhost"</span> <span class="na">debug=</span><span class="s">"0"</span> <span class="na">appBase=</span><span class="s">"webapps"</span> <span class="err">..</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;Valve</span> <span class="na">className=</span><span class="s">"org.apache.catalina.valves.RemoteAddrValve"</span> <span class="na">deny=</span><span class="s">"18\.83\.0\.150"</span> <span class="nt">/&gt;</span>
  ...
<span class="nt">&lt;/Host&gt;</span>
</code></pre>
</div>

<p>The value of the deny attribute must be one or more (comma delimited) regular expressions each of which will be compared to the remote clients IP addresses.
For instance:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>deny="18\.83\.0\.150,128\.100\.34\.99,128\.117\.140\..*"
</code></pre>
</div>

<p>NOTE: You need to restart the server before this will take effect.</p>

<h3 id="how-do-i-remove-servlet-autodeploy">How do I remove Servlet Autodeploy?</h3>

<p>Its recommended to remove autodetection of changes while Tomcat is running, for performance reasons.
In a production environment, its better to explicitly redeploy the application:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Host</span> <span class="na">name=</span><span class="s">"localhost"</span> <span class="na">appBase=</span><span class="s">"webapps"</span> <span class="na">unpackWARs=</span><span class="s">"true"</span> <span class="na">autoDeploy=</span><span class="s">"false"</span>
  <span class="na">xmlValidation=</span><span class="s">"false"</span> <span class="na">xmlNamespaceAware=</span><span class="s">"false"</span><span class="nt">&gt;</span>
  ...
<span class="nt">&lt;/Host&gt;</span>
</code></pre>
</div>

<h3 id="how-do-i-remove-port-8009-when-using-tomcat-in-standalone-mode">How do I remove port 8009 when using tomcat in standalone mode?</h3>

<p>Unless you are using Tomcat with the Apache server, comment out this line in server.xml:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Connector</span> <span class="na">port=</span><span class="s">"8009"</span> <span class="na">enableLookups=</span><span class="s">"false"</span> <span class="na">redirectPort=</span><span class="s">"8443"</span> <span class="na">protocol=</span><span class="s">"AJP/1.3"</span> <span class="nt">/&gt;</span>
</code></pre>
</div>

<h3 id="manager-fails-to-upload-new-threddswar-with-sizelimitexceededexception">Manager fails to upload new <code class="highlighter-rouge">thredds.war</code> with <code class="highlighter-rouge">SizeLimitExceededException</code></h3>

<p>You are using the Tomcat Manager, which limits the size of war file that can be uploaded.
You can install the war file directly into the tomcat webapps directory (using ssh/scp, for example), or you can change the manager configuration:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cd ${tomcat_home}/webapps/manager/WEB-INF/
vi web.xml
</code></pre>
</div>

<p>change  <code class="highlighter-rouge">&lt;max-file-size&gt;</code> and  <code class="highlighter-rouge">&lt;max-request-size&gt;</code> to be larger than the size of the <code class="highlighter-rouge">thredds.war</code> file.</p>

<p>You must restart tomcat for this to take effect.</p>

<h3 id="logging-is-not-working">Logging is not working</h3>

<p>You must use a version of Tomcat &gt;= 7.0.43. See <a href="http://logging.apache.org/log4j/2.0/manual/webapp.html" target="_blank">log4j2 docs</a>.</p>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Unidata. All rights reserved. <br />
<span>Page last updated:</span> 2017-01-03<br/> Site last generated: Sep 14, 2017 <br />
<p><img src="http://www.unidata.ucar.edu/images/logo.png" alt="UCAR/Unidata"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-92978945-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>