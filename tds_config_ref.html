<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>TDS Configuration File Reference (threddsConfig.xml) | THREDDS Documentation</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="www.unidata.ucar.edufeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> THREDDS Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">THREDDS Source<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/Unidata/THREDDS" target="_blank">netCDF-Java and TDS Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/Rosetta" target="_blank">Rosetta Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/siphon" target="_blank">Siphon Github Repo</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="tds_tutorial_index.html">THREDDS Data Server Tutorial</a></li>
                        
                        
                        
                        <li><a href="netcdf_java_tutorial_index.html">netCDF-Java Tutorial</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.unidata.ucar.edu/software/rosetta/docs/" target="_blank">Rosetta</a></li>
                        
                        
                        
                        <li><a href="https://siphon.readthedocs.io/en/latest/#" target="_blank">Siphon</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li><a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:support-thredds@unidta.ucar.edu?subject=THREDDS Documentation Feedback f eedback&body=I have some feedback about the TDS Configuration File Reference (threddsConfig.xml) page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a><li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="TDS Configuration File Reference (threddsConfig.xml)">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          







<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">TDS Tutorial 5.0.0</li>
    
    
    
        
    
    <li>
        <a href="#">Getting Started with the TDS</a>
        <ul>
            
            
            
            <li><a href="tds_tutorial_index.html">TDS Overview</a></li>
            
            
            
            
            
            
            <li><a href="install_java_tomcat.html">Installing Java and Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_dir_structure_qt.html">Tomcat Directory Structure</a></li>
            
            
            
            
            
            
            <li><a href="running_tomcat.html">Running Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_log_files.html">Tomcat Log Files</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_configuration_files.html">Tomcat Config Files</a></li>
            
            
            
            
            
            
            <li><a href="deploying_the_tds.html">Deploying the TDS</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_manager_app.html">Tomcat Manager Application</a></li>
            
            
            
            
            
            
            <li><a href="where_to_go_from_here.html">Where to go from here</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Client Catalogs</a>
        <ul>
            
            
            
            <li><a href="basic_client_catalog.html">Basic Client Catalog Primer</a></li>
            
            
            
            
            
            
            <li><a href="nested_datasets.html">Nested Datasets</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_metadata.html">Client Catalog Metadata</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_references.html">Catalog References</a></li>
            
            
            
            
            
            
            <li><a href="compound_service_elements.html">Compound service elements</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_xml_validation.html">XML Validation</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_via_toolsUI.html">Client Catalogs in ToolsUI</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">TDS Configuration</a>
        <ul>
            
            
            
            <li><a href="tds_content_directory.html">TDS Content Directory</a></li>
            
            
            
            
            
            
            <li><a href="default_config_catalog.html">Default TDS Configuration Catalog</a></li>
            
            
            
            
            
            
            <li><a href="basic_config_catalog.html">Basics of Configuration Catalogs</a></li>
            
            
            
            
            
            
            <li><a href="basic_tds_configuration.html">Basic TDS Configuration</a></li>
            
            
            
            
            
            
            <li><a href="adding_ogc_iso_services.html">Adding OGC / ISO Services</a></li>
            
            
            
            
            
            
            <li><a href="adding_ncss.html">Adding the netCDF Subset Service</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Monitoring and Debugging</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">TDS Monitoring and Debugging</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Tomcat and TDS Logs</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using the TdsMonitor Tool</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">3rd Party Tools</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">netCDF Markup Language (NcML)</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Basic NcML Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using NcML in the TDS</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Basic NcML Examples</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Feature Collections</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collections</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collection Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Files in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Tables in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Forecast Model Run Collections (FMRC)</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">FMRC Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Metadata</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">THREDDS Metadata</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">ISO Metadata Generation</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Production Servers</a>
        <ul>
            
            
            
            <li><a href="production_server_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Troubleshooting Problems</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Performance Tips</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Upgrading to 5.0</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Installation Checklist</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">FAQ</a>
        <ul>
            
            
            
            <li><a href="tds_faq.html">FAQ</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Reference Guide</a>
        <ul>
            
            
            
            <li class="active"><a href="tds_config_ref.html">TDS Config (threddsConfig.xml)</a></li>
            
            
            
            
            
            
            <li><a href="viewers_ref.html">Viewers</a></li>
            
            
            
            
            
            
            <li><a href="dataset_source_plugin.html">Data Source Plugins</a></li>
            
            
            
            
            
            
            <li><a href="wcs_ref.html">WCS Reference</a></li>
            
            
            
            
            
            
            <li><a href="wms_ref.html">WMS Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Remote Management Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Netcdf Subset Service Reference</a></li>
            
            
            
            
            
            
            <li><a href="tds_doc_guide.html">netCDF-Java and TDS Doc Guide</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">TDS Configuration File Reference (threddsConfig.xml)</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    

  <p>The TDS configuration file <code class="highlighter-rouge">${tds.content.root.path}/thredds/threddsConfig.xml</code> allows the TDS administrator to control the behavior of the TDS.</p>

<p>As of 5.0, if this file is missing, then default settings will be used.
We strongly encourage you to fill in the Server Information fields, but all other fields are optional, and default settings are used whenever you don’t override.
Generally its good practice to only include the elements you want to change from the defaults.</p>

<p>When changing <code class="highlighter-rouge">threddsConfig.xml</code>, you must restart the thredds webapp (e.g., through the Tomcat manager application) for them to take effect.</p>

<p><a href="https://raw.githubusercontent.com/Unidata/thredds/master/tds/src/main/webapp/WEB-INF/altContent/startup/threddsConfig.xml" target="_blank">Here</a> is an annotated example of <code class="highlighter-rouge">threddsConfig.xml</code>.</p>

<h2 id="tds-global-configuration-options">TDS global configuration options</h2>

<h3 id="server-information">Server Information</h3>

<p>In the <code class="highlighter-rouge">serverInformation</code> element, you provide basic information about your server including contact information, and information about the group that hosts the server.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;serverInformation&gt;</span>
    <span class="nt">&lt;name&gt;</span>Initial TDS Installation<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;logoUrl&gt;</span>/thredds/threddsIcon.png<span class="nt">&lt;/logoUrl&gt;</span>
    <span class="nt">&lt;logoAltText&gt;</span>Initial TDS Installation<span class="nt">&lt;/logoAltText&gt;</span>

    <span class="nt">&lt;abstract&gt;</span>Scientific Data<span class="nt">&lt;/abstract&gt;</span>
    <span class="nt">&lt;keywords&gt;</span>meteorology, atmosphere, climate, ocean, earth science<span class="nt">&lt;/keywords&gt;</span>

    <span class="nt">&lt;contact&gt;</span>
      <span class="nt">&lt;name&gt;</span>Support<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;organization&gt;</span>My Group<span class="nt">&lt;/organization&gt;</span>
      <span class="nt">&lt;email&gt;</span>support@my.group<span class="nt">&lt;/email&gt;</span>
      <span class="nt">&lt;phone&gt;&lt;/phone&gt;</span>
    <span class="nt">&lt;/contact&gt;</span>
    <span class="nt">&lt;hostInstitution&gt;</span>
      <span class="nt">&lt;name&gt;</span>My Group<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;webSite&gt;</span>http://www.my.group/<span class="nt">&lt;/webSite&gt;</span>
      <span class="nt">&lt;logoUrl&gt;</span>myGroup.gif<span class="nt">&lt;/logoUrl&gt;</span>
      <span class="nt">&lt;logoAltText&gt;</span>My Group<span class="nt">&lt;/logoAltText&gt;</span>
    <span class="nt">&lt;/hostInstitution&gt;</span>
<span class="nt">&lt;/serverInformation&gt;</span>
</code></pre>
</div>

<p>The information provided in the <code class="highlighter-rouge">serverInformation</code> element is used in:</p>

<ul>
  <li>the headers of all generated HTML pages (they contain the names and
logos of the server and host institution)</li>
  <li>the Server section of the WMS GetCapabilities response</li>
  <li>the server information documents (<a href="#server-information-documents">see below</a>)</li>
  <li>the Server section of the WCS GetCapabilities response</li>
  <li>all generated THREDDS catalogs that don’t override this information</li>
</ul>

<p>NOTE: The best way to use your own logo is to put it in the <code class="highlighter-rouge">${tds.content.root.path}/thredds/public/</code> directory, and specify it in <code class="highlighter-rouge">serverInformation</code> as <code class="highlighter-rouge">/thredds/&lt;name&gt;</code>, e.g.:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;logoUrl&gt;</span>/thredds/yourIcon.gif<span class="nt">&lt;/logoUrl&gt;</span>
</code></pre>
</div>

<h4 id="server-information-documents">Server Information Documents</h4>

<p>The TDS supports the following requests for server information:</p>

<ul>
  <li><code class="highlighter-rouge">/thredds/serverInfo.html</code> (<a href="https://thredds.ucar.edu/thredds/serverInfo.html" target="_blank">sample response</a>)</li>
  <li><code class="highlighter-rouge">/thredds/serverInfo.xml</code> (<a href="https://thredds.ucar.edu/thredds/serverInfo.xml" target="_blank">sample response</a>)</li>
  <li><code class="highlighter-rouge">/thredds/serverVersion.txt</code> (<a href="https://thredds.ucar.edu/thredds/serverVersion.txt" target="_blank">sample response</a>)</li>
</ul>

<h3 id="generated-html-pages">Generated HTML Pages</h3>

<p>In the <code class="highlighter-rouge">htmlSetup</code> element, you can configure which CSS documents are used in the HTML pages generated by the TDS.
Default CSS files are provided, and should not be modified. Instead, these can be overridden by placing the appropriate CSS files in the <code class="highlighter-rouge">${tds.content.root.path}/thredds/public/</code> directory and pointing to them here:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;htmlSetup&gt;</span>
  <span class="nt">&lt;standardCssUrl&gt;</span>tds.css<span class="nt">&lt;/standardCssUrl&gt;</span>  <span class="c">&lt;!--1--&gt;</span>
  <span class="nt">&lt;catalogCssUrl&gt;</span>tdsCat.css<span class="nt">&lt;/catalogCssUrl&gt;</span>  <span class="c">&lt;!--2--&gt;</span>
  <span class="nt">&lt;openDapCssUrl&gt;</span>tdsDap.css<span class="nt">&lt;/openDapCssUrl&gt;</span>  <span class="c">&lt;!--3--&gt;</span>
  <span class="nt">&lt;googleTrackingCode&gt;</span>UA-54516992-1<span class="nt">&lt;/googleTrackingCode&gt;</span>  <span class="c">&lt;!--4--&gt;</span>
<span class="nt">&lt;/htmlSetup&gt;</span>
</code></pre>
</div>
<ul>
  <li>&lt;1&gt; The CSS used in TDS dataset pages.</li>
  <li>&lt;2&gt; The CSS used in TDS catalogs pages</li>
  <li>&lt;3&gt; The CSS used in the OPeNDAP form.</li>
  <li>&lt;4&gt; Google Analytics Tracking Code (GATC) enables tracking catalog use.
    Obtain the GATC from <a href="http://www.google.com/analytics/" target="_blank">Google</a> and enter it here to enable this feature.</li>
</ul>

<h3 id="controlling-thredds-catalog-output">Controlling THREDDS catalog output</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;catalogWriting&gt;</span>
  <span class="nt">&lt;useBytesForDataSize&gt;</span>false<span class="nt">&lt;useBytesForDataSize/&gt;</span>
<span class="nt">&lt;/catalogWriting&gt;</span>
</code></pre>
</div>

<ul>
  <li>if true, in a TDS catalog, output the Data Size with exact byte count.
By default, it will output 4 significant digits, choosing units appropriately</li>
</ul>

<h3 id="extra-catalog-roots">Extra Catalog Roots</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;catalogRoot&gt;</span>tempCatalog.xml<span class="nt">&lt;/catalogRoot&gt;</span>
<span class="nt">&lt;catalogRoot&gt;</span>idd/catalog.xml<span class="nt">&lt;/catalogRoot&gt;</span>
<span class="nt">&lt;catalogRoot&gt;</span>catgen/subdir/enhancedCatalog-1.0.xml<span class="nt">&lt;/catalogRoot&gt;</span>
</code></pre>
</div>

<p>These elements name <em>catalog roots</em> that are not referenced from your default catalog root ( <code class="highlighter-rouge">${tds.content.root.path}/thredds/catalog.xml</code>).
On startup, the TDS reads the default catalog root and any root catalogs you list here, plus any catalogs that are referenced by them in a <code class="highlighter-rouge">catalogRef</code>.
Data roots and other needed information are found and cached.
All the catalogs found in this way are called <em>static catalogs</em>, and all static catalogs must live within the <code class="highlighter-rouge">${tds.content.root.path}/thredds</code> directory tree.</p>

<h3 id="adding-viewers">Adding Viewers</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Viewer&gt;</span>my.package.MyViewer<span class="nt">&lt;/Viewer&gt;</span>
</code></pre>
</div>

<p>You can place a link to your own <code class="highlighter-rouge">Viewer</code> on the TDS HTML page, by loading a <a href="/viewers_ref.html">Viewers</a> at runtime.
This line is needed in the config file only if you are writing your own Java class.</p>

<h3 id="adding-dataset-sources">Adding Dataset Sources</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;datasetSource&gt;</span>my.package.DatasetSourceImpl<span class="nt">&lt;/datasetSource&gt;</span>
</code></pre>
</div>

<p>You can add a <code class="highlighter-rouge">DataSource</code> - essentially an IOSP with access to Servlet request parameters, by loading a <a href="/dataset_source_plugin.html">Dataset Source Plugin</a> at runtime.</p>

<h3 id="checking-for-updates">Checking for Updates</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;TdsUpdateConfig&gt;</span>
  <span class="nt">&lt;logVersionInfo&gt;</span>true<span class="nt">&lt;/logVersionInfo&gt;</span>
<span class="nt">&lt;/TdsUpdateConfig&gt;</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">TdsUpdateConfig</code> element controls if the TDS checks with Unidata regarding possible updates.
The default (<code class="highlighter-rouge">true</code>) is for the TDS to check for the current stable and development release versions, and to log that information in the TDS <code class="highlighter-rouge">serverStartup.log</code> file as INFO entries.
If you do not want the TDS to check for this on startup, set this to <code class="highlighter-rouge">false</code>.</p>

<h2 id="controlling-data-services">Controlling Data Services</h2>

<h3 id="remote-catalog-service-for-catalogs">Remote Catalog Service for Catalogs</h3>

<p>Catalog services are available by default for catalogs served by the local TDS.
However, for remote catalogs, these services must be explicitly enabled in <code class="highlighter-rouge">threddsConfig.xml</code>:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;CatalogServices&gt;</span>
  <span class="nt">&lt;allowRemote&gt;</span>true<span class="nt">&lt;/allowRemote&gt;</span>
<span class="nt">&lt;/CatalogServices&gt;</span>
</code></pre>
</div>

<h3 id="opendap-service">OPeNDAP Service</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Opendap&gt;</span>
  <span class="nt">&lt;ascLimit&gt;</span>50<span class="nt">&lt;/ascLimit&gt;</span>
  <span class="nt">&lt;binLimit&gt;</span>500<span class="nt">&lt;/binLimit&gt;</span>
  <span class="nt">&lt;serverVersion&gt;</span>opendap/3.7<span class="nt">&lt;/serverVersion&gt;</span>
<span class="nt">&lt;/Opendap&gt;</span>
</code></pre>
</div>

<p>This controls the <code class="highlighter-rouge">OPeNDAP</code> data service.
Because its easy for a user to inadvertantly request very large amounts of data, the TDS limits the size of the data response. 
In our experience legitimate requests ask for subset sizes that are well below the defaults.</p>

<ul>
  <li><code class="highlighter-rouge">ascLimit</code>: maximum size of an ascii data request , in Megabytes.
 Default 50 Mbytes.</li>
  <li><code class="highlighter-rouge">binLimit</code>: maximum size of a binary data request , in Megabytes.
 Default is 500 Mbytes.</li>
  <li><code class="highlighter-rouge">serverVersion</code>: this is the String thats returned by the OPeNDAP <code class="highlighter-rouge">getVersion</code> request, and also placed into the <code class="highlighter-rouge">XDOS-Server</code> HTTP Header on all OPeNDAP responses.</li>
</ul>

<h3 id="wcs-service">WCS Service</h3>

<p>The OGC WCS service provided as part of the TDS is described in more detail <a href="/wcs_ref.html">here</a>.
By default this service is enabled, and can be disabled by including the following in the <code class="highlighter-rouge">threddsConfig.xml</code> file:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;WCS&gt;</span>
  <span class="nt">&lt;allow&gt;</span>false<span class="nt">&lt;/allow&gt;</span>
<span class="nt">&lt;/WCS&gt;</span>
</code></pre>
</div>

<p>The following shows all the configuration options available in the WCS section of the <code class="highlighter-rouge">threddsConfig.xml</code> file with the default values shown:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;WCS&gt;</span>
  <span class="nt">&lt;allow&gt;</span>true<span class="nt">&lt;/allow&gt;</span>
  <span class="nt">&lt;dir&gt;</span>(see the note below)<span class="nt">&lt;/dir&gt;</span>
  <span class="nt">&lt;scour&gt;</span>15 min<span class="nt">&lt;/scour&gt;</span>
  <span class="nt">&lt;maxAge&gt;</span>30 min<span class="nt">&lt;/maxAge&gt;</span>
<span class="nt">&lt;/WCS&gt;</span>
</code></pre>
</div>

<p>We recommend that you include in the <code class="highlighter-rouge">threddsConfig.xml</code> file only the options you want to change. 
Here is the description of the various options:</p>

<ul>
  <li><code class="highlighter-rouge">allow</code>: a value of <code class="highlighter-rouge">false</code> disables the WCS service.</li>
  <li><code class="highlighter-rouge">dir</code>: the working directory where generated files are cached before being sent to the client (see <a href="#disk-caching-and-temporary-files">choosing a
cache directory</a>).
If not otherwise set, the TDS will use the <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/wcs/</code> directory.
We recommend that you do not specify a <code class="highlighter-rouge">WCS.dir</code> element, and use the default.</li>
  <li><code class="highlighter-rouge">scour</code>: how often to scour the working directory, to delete files that were not successfully downloaded.</li>
  <li><code class="highlighter-rouge">maxAge</code>: how long to leave the files in the working directory while the download is occurring.
 The files are deleted after a successful download. Do not set to &lt;= 0.</li>
</ul>

<h3 id="wms-service">WMS Service</h3>

<p>The OGC WMS service provided as part of the TDS is described in more detail <a href="updateme">here</a> (TDS Web Map Service (WMS)).
By default this service is enabled, and can be disabled by including the following in the <code class="highlighter-rouge">threddsConfig.xml</code> file:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;WMS&gt;</span>
  <span class="nt">&lt;allow&gt;</span>false<span class="nt">&lt;/allow&gt;</span>
<span class="nt">&lt;/WMS&gt;</span>
</code></pre>
</div>

<p>The following shows all the configuration options available in the WMS section of the <code class="highlighter-rouge">threddsConfig.xml</code> file with the default values shown:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;WMS&gt;</span>
  <span class="nt">&lt;allow&gt;</span>true<span class="nt">&lt;/allow&gt;</span>
  <span class="nt">&lt;allowRemote&gt;</span>false<span class="nt">&lt;/allowRemote&gt;</span>
  <span class="nt">&lt;paletteLocationDir&gt;</span>/WEB-INF/palettes<span class="nt">&lt;/paletteLocationDir&gt;</span>
  <span class="nt">&lt;maxImageWidth&gt;</span>2048<span class="nt">&lt;/maxImageWidth&gt;</span>
  <span class="nt">&lt;maxImageHeight&gt;</span>2048<span class="nt">&lt;/maxImageHeight&gt;</span>
<span class="nt">&lt;/WMS&gt;</span>
</code></pre>
</div>

<p>We recommend that you include in the <code class="highlighter-rouge">threddsConfig.xml</code> file only the options you want to change.
Here is the description of the various options:</p>

<ul>
  <li><code class="highlighter-rouge">allow</code>: a value of <code class="highlighter-rouge">false</code> disables the WMS service.</li>
  <li><code class="highlighter-rouge">allowRemote</code>: a value of <code class="highlighter-rouge">true</code> enables the WMS service for datasets available from a remote server.</li>
  <li><code class="highlighter-rouge">paletteLocationDir</code>: optionally specify the location of the directory containing your own palette files, by specifying the directory
where they are contained.
If the directory location starts with a <code class="highlighter-rouge">/</code>, the path is absolute, otherwise it is relative to <code class="highlighter-rouge">${tds.content.root.path}/thredds/</code>.
If you don’t specify it, or specify it incorrectly, the default palettes will be used, which are in the war file under <code class="highlighter-rouge">WEB-INF/palettes</code>.</li>
  <li><code class="highlighter-rouge">maxImageWidth</code>: the maximum image width in pixels that this WMS service will return.</li>
  <li><code class="highlighter-rouge">maxImageHeight</code>: the maximum image height in pixels that this WMS service will return.</li>
</ul>

<h3 id="netcdf-subset-service-ncss">NetCDF Subset Service (NCSS)</h3>

<p>The NetCDF Subset Service provided as part of the TDS is described in more detail <a href="updateme">here</a> (NetCDF Subset Service Reference).
By default this service is enabled, and can be disabled by including the following in the <code class="highlighter-rouge">threddsConfig.xml</code> file:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;NetcdfSubsetService&gt;</span>
  <span class="nt">&lt;allow&gt;</span>false<span class="nt">&lt;/allow&gt;</span>
<span class="nt">&lt;/NetcdfSubsetService&gt;</span>
</code></pre>
</div>

<p>The following shows all the configuration options available in the NetcdfSubsetService section of the <code class="highlighter-rouge">threddsConfig.xml</code> file with the default values shown:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;NetcdfSubsetService&gt;</span>
  <span class="nt">&lt;allow&gt;</span>true<span class="nt">&lt;/allow&gt;</span>
  <span class="nt">&lt;dir&gt;</span>(see the note below)<span class="nt">&lt;/dir&gt;</span>
  <span class="nt">&lt;scour&gt;</span>15 min<span class="nt">&lt;/scour&gt;</span>
  <span class="nt">&lt;maxAge&gt;</span>30 min<span class="nt">&lt;/maxAge&gt;</span>
  <span class="nt">&lt;maxFileDownloadSize&gt;</span>300 MB<span class="nt">&lt;/maxFileDownloadSize&gt;</span>
<span class="nt">&lt;/NetcdfSubsetService&gt;</span>
</code></pre>
</div>

<p>We recommend that you include in the <code class="highlighter-rouge">threddsConfig.xml</code> file only the options you want to change.
Here is the description of the various options:</p>

<ul>
  <li><code class="highlighter-rouge">allow</code>: a value of <code class="highlighter-rouge">false</code> disables the NetCDF Subset Service.</li>
  <li><code class="highlighter-rouge">dir</code>: the working directory for creating files for download (see <a href="#disk-caching-and-temporary-files">choosing a cache directory</a>).
If not otherwise set, the TDS will use the <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/ncss/</code> directory. 
We recommend that you do not specify a <code class="highlighter-rouge">NetcdfSubsetService.dir</code> element, and use the default.</li>
  <li><code class="highlighter-rouge">scour</code>: how often to scour the working directory, to delete files that were not successfully downloaded.</li>
  <li><code class="highlighter-rouge">maxAge</code>: how long to leave the files in the working directory while the download is occurring.
The files are deleted after a successful download. Do not set to &lt;= 0.</li>
  <li><code class="highlighter-rouge">maxFileDownloadSize</code>: maximum size of file that can be requested.
Optional; default is that there is no size limitation.
If the file is &gt; 2 GB, large format netCDF will be written.</li>
</ul>

<h3 id="nciso-service">ncISO Service</h3>

<p>By default these services are enabled, and can be disabled by including the following in the <code class="highlighter-rouge">threddsConfig.xml</code> file:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;NCISO&gt;</span>
  <span class="nt">&lt;ncmlAllow&gt;</span>false<span class="nt">&lt;/ncmlAllow&gt;</span>
  <span class="nt">&lt;uddcAllow&gt;</span>false<span class="nt">&lt;/uddcAllow&gt;</span>
  <span class="nt">&lt;isoAllow&gt;</span>false<span class="nt">&lt;/isoAllow&gt;</span>
<span class="nt">&lt;/NCISO&gt;</span>
</code></pre>
</div>

<p>Each of the <code class="highlighter-rouge">allow</code> elements above enables the corresponding ncISO service (NCML, UDDC, and ISO).
The ncISO services are described in more detail on the ncISO <a href="updateme">reference page</a> (TDS and ncISO: Metadata Services).</p>

<h2 id="cdm-configuration">CDM Configuration</h2>

<h3 id="netcdf-4-c-library-loading">NetCDF-4 C library loading</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Netcdf4Clibrary&gt;</span>
  <span class="nt">&lt;libraryPath&gt;</span>/usr/local/lib<span class="nt">&lt;/libraryPath&gt;</span>
  <span class="nt">&lt;libraryName&gt;</span>netcdf<span class="nt">&lt;/libraryName&gt;</span>
  <span class="nt">&lt;useForReading&gt;</span>false<span class="nt">&lt;/useForReading&gt;</span>
<span class="nt">&lt;/Netcdf4Clibrary&gt;</span>
</code></pre>
</div>

<p>In order to write netCDF-4 files, you must have the <a href="http://www.unidata.ucar.edu/downloads/netcdf/index.jsp">netCDF-4 C library</a> version 4.3.1 or above—compiled and available on your system, along with all supporting libraries (HDF5, zlib, and curl).
The <a href="updateme">details</a> (netcdf-java netcdf4Clibrary reference page) of this differ for each operating system.
The elements above allow you to configure how the library is discovered and used.</p>

<ul>
  <li><code class="highlighter-rouge">libraryPath</code>: The directory in which the native library is installed.</li>
  <li><code class="highlighter-rouge">libraryName</code>: The name of the native library.
This will be used to locate the proper .DLL, .SO, or .DYLIB file within the <code class="highlighter-rouge">libraryPath</code> directory.</li>
  <li><code class="highlighter-rouge">useForReading</code>: By default, the native library is only used for writing NetCDF-4 files; a pure-Java layer is responsible for reading them.
However, if this property is set to true, then it will be used for reading NetCDF-4 (and HDF5) files as well.</li>
</ul>

<p>For TDS users, we recommend setting the library path and name in <code class="highlighter-rouge">threddsConfig.xml</code> as in the above example.</p>

<h3 id="netcdf-java-runtime-loading">NetCDF-Java runtime Loading</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;nj22Config&gt;</span>
  <span class="nt">&lt;ioServiceProvider</span> <span class="na">class=</span><span class="s">"edu.univ.ny.stuff.FooFiles"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;coordSysBuilder</span> <span class="na">convention=</span><span class="s">"foo"</span> <span class="na">class=</span><span class="s">"test.Foo"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;coordTransBuilder</span> <span class="na">name=</span><span class="s">"atmos_ln_sigma_coordinates"</span> <span class="na">type=</span><span class="s">"vertical"</span> <span class="na">class=</span><span class="s">"my.stuff.atmosSigmaLog"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;typedDatasetFactory</span> <span class="na">datatype=</span><span class="s">"Point"</span> <span class="na">class=</span><span class="s">"gov.noaa.obscure.file.Flabulate"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;table</span> <span class="na">type=</span><span class="s">"GRIB1"</span> <span class="na">filename=</span><span class="s">"/home/rkambic/grib/tables/userlookup.lst"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;table</span> <span class="na">type=</span><span class="s">"GRIB2"</span> <span class="na">filename=</span><span class="s">"/home/rkambic/grib/tables/grib2userparameters"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/nj22Config&gt;</span>
</code></pre>
</div>

<p>These elements allow you to specify <a href="updateme">runtime parameters</a> (netcdf-java RuntimeLoading reference page) for the Netcdf-Java library from the threddsConfig file.
See the Netcdf-Java <a href="updateme">tutorial</a> (netcdf-java turorial page) for an overview.</p>

<h3 id="aggregation">Aggregation</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Aggregation&gt;</span>
  <span class="nt">&lt;typicalDataset&gt;</span>penultimate<span class="nt">&lt;/typicalDataset&gt;</span>
<span class="nt">&lt;/Aggregation&gt;</span>
</code></pre>
</div>

<p>You can control how NcML Aggregation chooses its typical/template dataset — the one it uses to populate the metadata for the resulting aggregated dataset.
Valid values are <code class="highlighter-rouge">first, random, latest</code>, and <code class="highlighter-rouge">penultimate</code> (latest but one). The default is <code class="highlighter-rouge">penultimate</code>.</p>

<h2 id="disk-caching-and-temporary-files">Disk Caching and temporary files</h2>

<p>The various cache directory locations are all under <code class="highlighter-rouge">\{tds.content.root.path}/thredds/</code> by default:</p>

<table>
  <tbody>
    <tr>
      <td>cache</td>
      <td>location</td>
      <td>description</td>
    </tr>
    <tr>
      <td>AggregationCache.dir</td>
      <td><code class="highlighter-rouge">cache/agg/</code></td>
      <td>for joinExisting aggregations only: write XML files here.</td>
    </tr>
    <tr>
      <td>CdmRemote.dir</td>
      <td><code class="highlighter-rouge">cache/cdmr/</code></td>
      <td>temporary files for cdmremote and cdmrFeature</td>
    </tr>
    <tr>
      <td>CdmValidatorService.dir</td>
      <td><code class="highlighter-rouge">cache/cdmValidate/</code></td>
      <td>temporary files for cdmvalidator (seperate war)</td>
    </tr>
    <tr>
      <td>DiskCache.dir</td>
      <td><code class="highlighter-rouge">cache/cdm/</code></td>
      <td>only used when non-writeable data directory or <code class="highlighter-rouge">alwaysUse</code> = true; puts CDM indexes, decompressed files, etc. into this directory</td>
    </tr>
    <tr>
      <td>GribIndex.dir</td>
      <td><code class="highlighter-rouge">cache/grib/</code></td>
      <td>put GRIB Index files (gbx9, ncx4) in this directory</td>
    </tr>
    <tr>
      <td>FeatureCollectionCache.dir</td>
      <td><code class="highlighter-rouge">cache/collection/</code></td>
      <td>when we read GridDataset for FMRC, write an XML summary, store in BDB in this directory</td>
    </tr>
    <tr>
      <td>NetcdfSubsetService.dir</td>
      <td><code class="highlighter-rouge">cache/ncss/</code></td>
      <td>temporary files for NCSS</td>
    </tr>
    <tr>
      <td>WCS.dir</td>
      <td><code class="highlighter-rouge">cache/wcs/</code></td>
      <td>temporary files for WCS</td>
    </tr>
  </tbody>
</table>

<p>We recommend that you use these defaults, by not specifying them in the threddsConfig.xml file.
If you need to move the cache location, move all of them by using a symbolic file link in <code class="highlighter-rouge"><span class="p">{</span><span class="err">tds.content.root.path</span><span class="p">}</span><span class="err">/thredds/</span></code>.
At Unidata, we move the entire content directory by creating a symbolic link:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> <span class="o">{</span>tomcat_home<span class="o">}</span>
ln -s /data/thredds/content content
</code></pre>
</div>

<p>These various caches at times may contain large amounts of data. 
You should choose a location that will not fill up (especially if that location affects other important locations like /opt, /home, etc).
If you have a large disk for your data, that may be a good location for the cache directories.
On unix-like machines, you can run <code class="highlighter-rouge">df</code> to get a listing of disks on your machine.
The listing includes size and mount location.</p>

<p>The following elements allow fine grain control over the location and scouring of each of these.</p>

<h3 id="cdm-library-disk-cache">CDM library Disk cache</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;DiskCache&gt;</span>
  <span class="nt">&lt;alwaysUse&gt;</span>false<span class="nt">&lt;/alwaysUse&gt;</span>
  <span class="nt">&lt;dir&gt;</span>/temp/cache/<span class="nt">&lt;/dir&gt;</span>
  <span class="nt">&lt;scour&gt;</span>1 hour<span class="nt">&lt;/scour&gt;</span>
  <span class="nt">&lt;maxSize&gt;</span>10 Gb<span class="nt">&lt;/maxSize&gt;</span>
<span class="nt">&lt;/DiskCache&gt;</span>
</code></pre>
</div>

<p>These elements control where the <code class="highlighter-rouge">CDM/NetCDF-Java</code> library writes temporary files, for example when it needs to unzip files, or write GRIB index files, etc.
If <code class="highlighter-rouge">alwaysUse</code> is <code class="highlighter-rouge">true</code>, these temporary files will always be written to the <em>cache directory</em> specified by <code class="highlighter-rouge">dir</code>
(see <a href="#disk-caching-and-temporary-files">choosing a cache directory</a>).
If <code class="highlighter-rouge">alwaysUse</code> is <code class="highlighter-rouge">false</code>, TDS will try to write them to the same directory as the original file, and if the TDS doesnt have write permission it will then write the files to the cache directory.
Write permission will be determined by what rights the <em>Tomcat user</em> has (the user that starts up Tomcat).
For security reasons, you want to carefully limit the file permissions of the Tomcat user.</p>

<p>When opening a file, if <code class="highlighter-rouge">alwaysUse</code> is <code class="highlighter-rouge">true</code>, TDS looks only in the cache directory for the temporary file. 
If <code class="highlighter-rouge">alwaysUse</code> is <code class="highlighter-rouge">false</code>, TDS wil first look for the temporary file in the same directory as the original file, and if not found, then will look in the cache.</p>

<p>Every <code class="highlighter-rouge">scour</code> amount of time, the largest items in the cache will be deleted, until the directory has less than <code class="highlighter-rouge">maxSize</code> bytes.
Note that the directory will sometimes exceed <code class="highlighter-rouge">maxSize</code>, and will only be knocked back to <code class="highlighter-rouge">maxSize</code> when the scour thread runs.
To turn off scouring, set the scour time to 0 (eg <code class="highlighter-rouge">0 secs</code>).</p>

<p>If not otherwise set, the TDS will use the <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/cdm</code> directory.
We recommend that you use this default, by not specifying the <code class="highlighter-rouge">DiskCache.dir</code> element.</p>

<h3 id="aggregation-cache">Aggregation Cache</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;AggregationCache&gt;</span>
  <span class="nt">&lt;dir&gt;</span>${tds.content.root.path}/thredds/cache/agg/<span class="nt">&lt;/dir&gt;</span>
  <span class="nt">&lt;scour&gt;</span>24 hours<span class="nt">&lt;/scour&gt;</span>
  <span class="nt">&lt;maxAge&gt;</span>90 days<span class="nt">&lt;/maxAge&gt;</span>
  <span class="nt">&lt;cachePathPolicy&gt;</span>nestedDirectory<span class="nt">&lt;/cachePathPolicy&gt;</span>
<span class="nt">&lt;/AggregationCache&gt;</span>
</code></pre>
</div>

<p>If you have <code class="highlighter-rouge">joinExisting</code> Aggregations, coordinate information will be written to a cache directory specified by <code class="highlighter-rouge">dir</code> (see <a href="#disk-caching-and-temporary-files">choosing a cache directory</a>). 
If not otherwise set, the TDS will use the <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/agg/</code> directory.
We recommend that you use this default, by not specifying a <code class="highlighter-rouge">AggregationCache</code>.<code class="highlighter-rouge">dir</code> element.</p>

<p>Every <code class="highlighter-rouge">scour</code> amount of time, any item that hasnt been changed since <code class="highlighter-rouge">maxAge</code> time will be deleted.
If you have aggregations that never change, set <code class="highlighter-rouge">scour</code> to <code class="highlighter-rouge">-1</code> to disable the operation.
Otherwise, make <code class="highlighter-rouge">maxAge</code> longer than the longest time between changes.
Basically, you don’t want to remove active aggregations.</p>

<p><code class="highlighter-rouge">cachePathPolicy</code> controls how cache files are stored in <code class="highlighter-rouge">dir</code>.
It must be set to one of <code class="highlighter-rouge">oneDirectory</code> or <code class="highlighter-rouge">nestedDirectory</code> (the default). 
<code class="highlighter-rouge">oneDirectory</code> will put all cache files into the same directory, while <code class="highlighter-rouge">nestedDirectory</code> will preserve their directory structure.
Use <code class="highlighter-rouge">nestedDirectory</code> for large aggregations, as some file systems struggle when a directory contains thousands of files.</p>

<p>This cache information is intended to be permanent; it stores coordinate information from each file in the aggregation, so that the file does not have to be opened each time the dataset is opened.
If you have large <code class="highlighter-rouge">joinExisting</code> aggregations, there will be a very pronounced difference with and without this cache.</p>

<p>The cache information is updated based on the <code class="highlighter-rouge">recheckEvery</code> field in the <code class="highlighter-rouge">joinExisting</code> aggregation element.</p>

<h3 id="featurecollection-cache">FeatureCollection cache</h3>

<p>This is where persistent information is kept about FMRCs, in order to speed them up.
We recommend that you use the default settings, by not specifying this option.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code> <span class="nt">&lt;FeatureCollection&gt;</span>
   <span class="nt">&lt;dir&gt;</span>${tds.content.root.path}/thredds/cache/collection/<span class="nt">&lt;/dir&gt;</span>
   <span class="nt">&lt;maxSize&gt;</span>20 Mb<span class="nt">&lt;/maxSize&gt;</span>
   <span class="nt">&lt;jvmPercent&gt;</span>2<span class="nt">&lt;/jvmPercent&gt;</span>
 <span class="nt">&lt;/FeatureCollection&gt;</span>
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">dir</code>: location of Feature Collection cache, currently implemented
with <a href="http://www.oracle.com/technetwork/database/berkeleydb/overview/index-093405.html" target="_blank">Berkeley DB</a>. 
If not otherwise set, the TDS will use the<code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/collection/</code> directory.
We recommend that you use this default, by not specifying a <code class="highlighter-rouge">FeatureCollection.dir</code> element.</li>
  <li><code class="highlighter-rouge">maxSize</code>: maximum amount of memory to be used for this cache.</li>
  <li><code class="highlighter-rouge">jvmPercent</code>: alternately, set the memory use as a percent of JVM memory, i.e. <code class="highlighter-rouge">-Xmx</code> value.
<code class="highlighter-rouge">maxSize</code> will override if present. Default is 2 %.</li>
</ul>

<h3 id="grib-index-redirection">GRIB Index redirection</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;GribIndex&gt;</span>
  <span class="nt">&lt;alwaysUse&gt;</span>false<span class="nt">&lt;/alwaysUse&gt;</span>
  <span class="nt">&lt;neverUse&gt;</span>false<span class="nt">&lt;/neverUse&gt;</span>
  <span class="nt">&lt;dir&gt;</span>${tds.content.root.path}/thredds/cache/grib/<span class="nt">&lt;/dir&gt;</span>
  <span class="nt">&lt;policy&gt;</span>nestedDirectory<span class="nt">&lt;/policy&gt;</span>
  <span class="nt">&lt;scour&gt;</span>0 hours<span class="nt">&lt;/scour&gt;</span>
  <span class="nt">&lt;maxAge&gt;</span>90 days<span class="nt">&lt;/maxAge&gt;</span>
<span class="nt">&lt;/GribIndex&gt;</span>
</code></pre>
</div>

<p>These elements control where Grib index files are written.</p>

<ul>
  <li>If <code class="highlighter-rouge">alwaysUse</code> is true, grib index files will always be written to the <em>index directory</em> specified by <code class="highlighter-rouge">dir</code> (see <a href="#disk-caching-and-temporary-files">choosing a cache directory</a>).
If <code class="highlighter-rouge">neverUse</code> is true, the index directory will never be used. 
If neither is set, the TDS will try to write grib indexes to the same directory as the original file, and if the TDS doesnt have write permission it will then write the files to the index directory.
Write permission will be determined by what rights the <em>Tomcat user</em> has (the user that starts up Tomcat).
For security reasons, you want to carefully limit the file permissions of the Tomcat user.</li>
  <li>The policy must be set to one of <code class="highlighter-rouge">oneDirectory</code> or <code class="highlighter-rouge">nestedDirectory</code> (the default). 
<code class="highlighter-rouge">oneDirectory</code> will put all index files into the same directory, while <code class="highlighter-rouge">nestedDirectory</code> will preserve the directory structure
of the index files. 
Use <code class="highlighter-rouge">nestedDirectory</code> for large collections of files, as some file systems struggle when a directory contains thousands of files.</li>
  <li>Every <code class="highlighter-rouge">scour</code> amount of time, any files in the cache that are older than <code class="highlighter-rouge">maxAge</code> will be removed.
To turn off scouring, set the scour time to 0 (eg <code class="highlighter-rouge">0 hours</code>), or leave out the <code class="highlighter-rouge">&lt;scour&gt;</code> element.
Typically you do <code class="highlighter-rouge">not</code> want to scour the indices.</li>
</ul>

<p>Managing the GRIB indices is an important task, and can be difficult if the files are changing, as in a rolling archive, or for very large collections.
There are two typical ways to do this:</p>

<ul>
  <li>
    <p>For rolling archives, allow the indices to be written in the same directory as the data files by specifying <code class="highlighter-rouge">&lt;neverUse&gt;true&lt;/neverUse&gt;</code> or by not using a <code class="highlighter-rouge">&lt;neverUse&gt;</code> or <code class="highlighter-rouge">&lt;alwaysUse&gt;</code> element (which uses the default behavior). 
When you delete the data files, delete the corresponding indices.</p>
  </li>
  <li>
    <p>If you need to keep the index files separate from your data files, set <code class="highlighter-rouge">&lt;alwaysUse&gt;true&lt;/alwaysUse&gt;</code>, and use <code class="highlighter-rouge">&lt;policy&gt;nestedDirectory&lt;/policy&gt;</code>.
There is currently no way to specify different cache directories for different datasets.
All GRIB indices, both <code class="highlighter-rouge">gbx9</code> and <code class="highlighter-rouge">ncx4</code>, are kept in the same cache.</p>
  </li>
</ul>

<p>A good rule of thumb is that the index files will need disk space between 500 and 1000 times smaller than the size of the grib data files.
So, a 1 Terabyte collection of GRIB data will need up to 2 GB of indices.</p>

<h2 id="object-caching">Object Caching</h2>

<p>The default settings will work well enough, and you should only tune them if you have performance problems, and are able to monitor their effect.</p>

<h3 id="file-handle-caching">File Handle Caching</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;RandomAccessFile&gt;</span>
  <span class="nt">&lt;minFiles&gt;</span>400<span class="nt">&lt;/minFiles&gt;</span>
  <span class="nt">&lt;maxFiles&gt;</span>500<span class="nt">&lt;/maxFiles&gt;</span>
  <span class="nt">&lt;scour&gt;</span>11 min<span class="nt">&lt;/scour&gt;</span>
<span class="nt">&lt;/RandomAccessFile&gt;</span>
</code></pre>
</div>

<p>There is a pool of shared <code class="highlighter-rouge">RandomAccessFile</code> objects, each of which stores an open OS file handle.
Since each OS has a maximum on the number of open file handles per process, you must make sure that the sum of the maxFiles does not exceed your OS maximum.
For better performance, make these numbers as high as possible.</p>

<h3 id="netcdffile-objects">NetcdfFile Objects</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;NetcdfFileCache&gt;</span>
  <span class="nt">&lt;minFiles&gt;</span>100<span class="nt">&lt;/minFiles&gt;</span>
  <span class="nt">&lt;maxFiles&gt;</span>150<span class="nt">&lt;/maxFiles&gt;</span>
  <span class="nt">&lt;scour&gt;</span>12 min<span class="nt">&lt;/scour&gt;</span>
<span class="nt">&lt;/NetcdfFileCache&gt;</span>
</code></pre>
</div>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;TimePartition&gt;</span>
  <span class="nt">&lt;minFiles&gt;</span>100<span class="nt">&lt;/minFiles&gt;</span>
  <span class="nt">&lt;maxFiles&gt;</span>150<span class="nt">&lt;/maxFiles&gt;</span>
  <span class="nt">&lt;scour&gt;</span>13 min<span class="nt">&lt;/scour&gt;</span>
<span class="nt">&lt;/TimePartition&gt;</span>
</code></pre>
</div>

<p>These elements control the size of the TDS cache for objects for 1) <code class="highlighter-rouge">NetcdfFile</code> objects, and 2) <code class="highlighter-rouge">Grib Partition</code> files, respectively.
Up to <code class="highlighter-rouge">maxFiles</code> objects will be cached, and every <code class="highlighter-rouge">scour</code> amount of time, older items in the cache will be released, until only <code class="highlighter-rouge">minFiles</code> objects are left.
The <code class="highlighter-rouge">scour</code> element uses any valid <code class="highlighter-rouge">udunits</code> time string, such as <code class="highlighter-rouge">sec, min, hour, day</code>. To disable the cache, set <code class="highlighter-rouge">maxFiles</code> to 0.</p>

<h2 id="catalog-processing">Catalog Processing</h2>

<h3 id="configuration-catalog">Configuration Catalog</h3>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;ConfigCatalog&gt;</span>
  <span class="nt">&lt;keepInMemory&gt;</span>100<span class="nt">&lt;/keepInMemory&gt;</span>
  <span class="nt">&lt;reread&gt;</span>always<span class="nt">&lt;/reread&gt;</span>
  <span class="nt">&lt;dir&gt;</span>/tomcat_home/content/thredds/cache/catalog/<span class="nt">&lt;/dir&gt;</span>
  <span class="nt">&lt;maxDatasets&gt;</span>10000<span class="nt">&lt;/maxDatasets&gt;</span>
<span class="nt">&lt;/ConfigCatalog&gt;</span>
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">keepInMemory</code>: Configuration catalogs are always cached in memory, for performance reasons.
You can set the maximum number of catalogs in the cache.
The amount of memory used by a catalog can be approximated simply by the size in bytes of the <code class="highlighter-rouge">catalog.xml</code> file itself.</li>
  <li><code class="highlighter-rouge">reread</code>:
    <ul>
      <li><code class="highlighter-rouge">always</code>: on startup, all catalogs are read. (default).
<em>safest, use if there are a small number of catalogs.</em></li>
      <li><code class="highlighter-rouge">check</code>: on startup, catalogs that have changed will be reread.</li>
      <li><code class="highlighter-rouge">trigger</code>: after initial read, config catalogs will only be read again if user explicitly triggers it.
<em>fastest startup if catalogs rarely change.</em></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">dir</code>: The location where the database is written. 
Default is <code class="highlighter-rouge">${tds.content.root.path}/thredds/cache/catalog/</code>.
We recommend that you leave the default and use a symbolic link to move it if needed.</li>
  <li><code class="highlighter-rouge">maxDatasets</code>: The maximum number of datasets.</li>
</ul>

<p>Several files will be created in the directory, including one large memory-mapped file about 500 bytes * maxDatasets.
These files are the persistent catalog cache, and can be deleted (when the TDS is stopped), which forces a complete read of the configuration catalogs the next time TDS starts up.</p>

<p>If the maximum number of datasets increases over the limit you have already set, shut down TDS, delete the catalog cache files, change
<code class="highlighter-rouge">maxDatasets</code> in <code class="highlighter-rouge">threddsConfig.xml</code>, and restart.
The catalogs will be reread.</p>

<p>Windows may have problems with memory-mapped large files (&gt; 4 GBytes, thus &gt; 7M datastes), and so Linux is preferred for large installations.</p>

<h3 id="user-triggering">User Triggering</h3>

<p>You must have [Remote Managenment(updateme) (RemoteManagement reference page) enabled (enable SSL in Tomcat, and login as a user with the <code class="highlighter-rouge">tdsConfig</code> user-role).</p>

<p>From Admin page <code class="highlighter-rouge">https://server/thredds/admin/debug</code>:</p>

<ul>
  <li>https://localhost:8443/thredds/admin/debug?Catalogs/reinit (Read all catalogs)</li>
  <li>https://localhost:8443/thredds/admin/debug?Catalogs/recheck (Read changed catalogs)</li>
</ul>

<p>From a program or script, an authenticated user can make a GET HTTP call to:</p>

<ul>
  <li><code class="highlighter-rouge">https://server/thredds/admin/catalog?req=readAll</code></li>
  <li><code class="highlighter-rouge">https://server/thredds/admin/catalog?req=readChanged</code></li>
</ul>

<h3 id="watch-mode-not-implemented-yet">Watch Mode (NOT IMPLEMENTED YET)</h3>

<p>In this mode, the TDS will not read all catalogs in when starting, but will only read in root catalogs and catalogs that have changed.
If using <code class="highlighter-rouge">catalogScan</code>, the catalogScan directories will be watched and any changes made while TDS is running will be detected.</p>

<p>To use this mode, the following conditions must be met:</p>

<ul>
  <li>all <code class="highlighter-rouge">dataRoot</code> elements must be in a root catalog.
A root catalog is the top catalog (<code class="highlighter-rouge">${tds.content.root.path}/thredds/catalog.xml</code>), plus any other catalogs specified in a <a href="#extra-catalog-roots">catalogRoot element</a>.</li>
  <li>all catalogs are referenced in a <code class="highlighter-rouge">catalogRef</code> element in a root catalog, or you are using <code class="highlighter-rouge">catalogScan</code> from a root catalog.</li>
</ul>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Unidata. All rights reserved. <br />
<span>Page last updated:</span> 2016-01-18<br/> Site last generated: Sep 14, 2017 <br />
<p><img src="http://www.unidata.ucar.edu/images/logo.png" alt="UCAR/Unidata"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-92978945-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>