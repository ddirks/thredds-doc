<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Running Tomcat | THREDDS Documentation</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="www.unidata.ucar.edufeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> THREDDS Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">THREDDS Source<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/Unidata/THREDDS" target="_blank">netCDF-Java and TDS Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/Rosetta" target="_blank">Rosetta Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/siphon" target="_blank">Siphon Github Repo</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="tds_tutorial_index.html">THREDDS Data Server Tutorial</a></li>
                        
                        
                        
                        <li><a href="netcdf_java_tutorial_index.html">netCDF-Java Tutorial</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.unidata.ucar.edu/software/rosetta/docs/" target="_blank">Rosetta</a></li>
                        
                        
                        
                        <li><a href="https://siphon.readthedocs.io/en/latest/#" target="_blank">Siphon</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li><a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:support-thredds@unidta.ucar.edu?subject=THREDDS Documentation Feedback f eedback&body=I have some feedback about the Running Tomcat page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a><li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Running Tomcat">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          







<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">TDS Tutorial 5.0.0</li>
    
    
    
        
    
    <li>
        <a href="#">Getting Started with the TDS</a>
        <ul>
            
            
            
            <li><a href="tds_tutorial_index.html">TDS Overview</a></li>
            
            
            
            
            
            
            <li><a href="install_java_tomcat.html">Installing Java and Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_dir_structure_qt.html">Tomcat Directory Structure</a></li>
            
            
            
            
            
            
            <li class="active"><a href="running_tomcat.html">Running Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_log_files.html">Tomcat Log Files</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_configuration_files.html">Tomcat Config Files</a></li>
            
            
            
            
            
            
            <li><a href="deploying_the_tds.html">Deploying the TDS</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_manager_app.html">Tomcat Manager Application</a></li>
            
            
            
            
            
            
            <li><a href="where_to_go_from_here.html">Where to go from here</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Client Catalogs</a>
        <ul>
            
            
            
            <li><a href="basic_client_catalog.html">Basic Client Catalog Primer</a></li>
            
            
            
            
            
            
            <li><a href="nested_datasets.html">Nested Datasets</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_metadata.html">Client Catalog Metadata</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_references.html">Catalog References</a></li>
            
            
            
            
            
            
            <li><a href="compound_service_elements.html">Compound service elements</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_xml_validation.html">XML Validation</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_via_toolsUI.html">Client Catalogs in ToolsUI</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">TDS Configuration</a>
        <ul>
            
            
            
            <li><a href="tds_content_directory.html">TDS Content Directory</a></li>
            
            
            
            
            
            
            <li><a href="default_config_catalog.html">Default TDS Configuration Catalog</a></li>
            
            
            
            
            
            
            <li><a href="basic_config_catalog.html">Basics of Configuration Catalogs</a></li>
            
            
            
            
            
            
            <li><a href="basic_tds_configuration.html">Basic TDS Configuration</a></li>
            
            
            
            
            
            
            <li><a href="adding_ogc_iso_services.html">Adding OGC / ISO Services</a></li>
            
            
            
            
            
            
            <li><a href="adding_ncss.html">Adding the netCDF Subset Service</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Monitoring and Debugging</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">TDS Monitoring and Debugging</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Tomcat and TDS Logs</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using the TdsMonitor Tool</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">3rd Party Tools</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">netCDF Markup Language (NcML)</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Basic NcML Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using NcML in the TDS</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Basic NcML Examples</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Feature Collections</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collections</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collection Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Files in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Tables in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Forecast Model Run Collections (FMRC)</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">FMRC Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Metadata</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">THREDDS Metadata</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">ISO Metadata Generation</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Production Servers</a>
        <ul>
            
            
            
            <li><a href="production_server_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Troubleshooting Problems</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Performance Tips</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Upgrading to 5.0</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Installation Checklist</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">FAQ</a>
        <ul>
            
            
            
            <li><a href="tds_faq.html">FAQ</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Reference Guide</a>
        <ul>
            
            
            
            <li><a href="tds_config_ref.html">TDS Config (threddsConfig.xml)</a></li>
            
            
            
            
            
            
            <li><a href="viewers_ref.html">Viewers</a></li>
            
            
            
            
            
            
            <li><a href="dataset_source_plugin.html">Data Source Plugins</a></li>
            
            
            
            
            
            
            <li><a href="wcs_ref.html">WCS Reference</a></li>
            
            
            
            
            
            
            <li><a href="wms_ref.html">WMS Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Remote Management Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Netcdf Subset Service Reference</a></li>
            
            
            
            
            
            
            <li><a href="tds_doc_guide.html">netCDF-Java and TDS Doc Guide</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Running Tomcat</h1>
</div>



<div class="post-content">

   

    

    

    

    

  <h2 id="starting--stopping-tomcat">Starting &amp; stopping Tomcat</h2>

<ol>
  <li>
    <p>Tomcat isn’t currently running so we need to start it up.</p>

    <p>Run the startup.sh script in the Tomcat bin/ directory:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">pwd</span>
/usr/local/tds/apache-tomcat-8.0.24

<span class="gp">$ </span>bin/startup.sh
</code></pre>
    </div>
  </li>
  <li>
    <p>Verify Tomcat is running.</p>

    <p>Look and see if you have a Tomcat process running:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ps -ef | grep tomcat
tds      21912     1 29 09:39 pts/1    00:00:02 /usr/bin/java -Djava.util.logging.config.file<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/conf/logging.properties -Djava.util.logging.manager<span class="o">=</span>org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/endorsed -classpath /usr/local/tds/apache-tomcat-8.0.24/bin/bootstrap.jar:/usr/local/tds/apache-tomcat-8.0.24/bin/tomcat-juli.jar -Dcatalina.base<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24 -Dcatalina.home<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24 -Djava.io.tmpdir<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/temp org.apache.catalina.startup.Bootstrap start
tds      21933 21675  0 09:39 pts/1    00:00:00 grep tomcat
</code></pre>
    </div>

    <p>Open a new browser window/tab and go to http://localhost:8080/ to verify Tomcat is running:</p>

    <figure><img class="docimage" src="images/tds/tutorial/getting_started/congratulations.png" alt="Tomcat Default Home Page" /><figcaption>If you see this page, Tomcat is running!</figcaption></figure>
  </li>
  <li>
    <p>See if you can shutdown Tomcat.</p>

    <p>Run the <code class="highlighter-rouge">shutdown.sh</code> script in the Tomcat <code class="highlighter-rouge">bin/</code> directory:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>bin/shutdown.sh
</code></pre>
    </div>
  </li>
</ol>

<div class="alert alert-info" role="alert"><i class="fa fa-question-circle"></i> <b>Question:</b> 
Which Java is Tomcat currently using? (Hint: what was sent to <code class="highlighter-rouge">STDOUT</code> when running <code class="highlighter-rouge">startup.sh</code> and <code class="highlighter-rouge">shutdown.sh</code>?)
</div>

<div class="alert alert-warning" role="alert"><i class="fa fa-cogs"></i> <b>Troubleshooting:</b> 
Check the logs mostly recently generated in the Tomcat logs for clues about why Tomcat failed to start or stop.
Pay particular attention to what is being reported in Tomcat’s main log file: catalina.out.
</div>

<h2 id="setting-java_home-java_opts-catalina_base-and-content_root">Setting <code class="highlighter-rouge">$JAVA_HOME</code>, <code class="highlighter-rouge">$JAVA_OPTS</code>, <code class="highlighter-rouge">$CATALINA_BASE</code>, and <code class="highlighter-rouge">$CONTENT_ROOT</code></h2>

<div class="alert alert-warning" role="alert"><i class="fa fa-cogs"></i> <b>Troubleshooting:</b> 
If you’re running Tomcat on an instance of Windows OS, you will want to create a setenv.bat file.
</div>

<p>We are going to create a file called <code class="highlighter-rouge">setenv.sh</code> in the Tomcat <code class="highlighter-rouge">bin/</code> directory to:</p>

<ul>
  <li>
    <p>allow Tomcat to reference/find the location of <code class="highlighter-rouge">$JAVA_HOME</code> and <code class="highlighter-rouge">$CATALINA_BASE</code>) during startup and shutdown;</p>
  </li>
  <li>
    <p>increase the amount of memory allocated to the JVM to enhance performance by setting <code class="highlighter-rouge">$JAVA_OPTS</code>; and</p>
  </li>
  <li>
    <p>add additional settings to the JVM via <code class="highlighter-rouge">$JAVA_OPTS</code> to enable more advanced services we will be learning about later on in this workshop.</p>
  </li>
</ul>

<ol>
  <li>
    <p>Create the <code class="highlighter-rouge">setenv.sh</code> file.</p>

    <p>Using your favorite text editor (gedit, vi, emacs, etc.), create a new file called setenv.sh in the Tomcat <code class="highlighter-rouge">bin/</code> directory:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">pwd</span>
/usr/local/tds/apache-tomcat-8.0.24

<span class="gp">$ </span><span class="nb">cd </span>bin
<span class="gp">$ </span>vi setenv.sh
Add the following information and save your setenv.sh file:

<span class="c">#!/bin/sh</span>
<span class="c">#</span>
<span class="c"># ENVARS for Tomcat</span>
<span class="c">#</span>
<span class="nb">export </span><span class="nv">CATALINA_HOME</span><span class="o">=</span><span class="s2">"/usr/local/tomcat"</span>

<span class="nb">export </span><span class="nv">CATALINA_BASE</span><span class="o">=</span><span class="s2">"/usr/local/tomcat"</span>

<span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span><span class="s2">"/usr"</span>

<span class="c"># TDS specific ENVARS</span>
<span class="c">#</span>
<span class="c"># Define where the TDS content directory will live</span>
<span class="c">#   THIS IS CRITICAL and there is NO DEFAULT - the</span>
<span class="c">#   TDS will not start without this.</span>
<span class="c">#</span>
<span class="nv">CONTENT_ROOT</span><span class="o">=</span>-Dtds.content.root.path<span class="o">=</span>/usr/local/tomcat/content

<span class="c"># set java prefs related variables (used by the wms service, for example)</span>
<span class="nv">JAVA_PREFS_ROOTS</span><span class="o">=</span><span class="s2">"-Djava.util.prefs.systemRoot=</span><span class="nv">$CATALINA_HOME</span><span class="s2">/content/thredds/javaUtilPrefs </span><span class="se">\</span><span class="s2">
                  -Djava.util.prefs.userRoot=</span><span class="nv">$CATALINA_HOME</span><span class="s2">/content/thredds/javaUtilPrefs"</span>

<span class="c">#</span>
<span class="c"># Some commonly used JAVA_OPTS settings:</span>
<span class="c">#</span>
<span class="nv">NORMAL</span><span class="o">=</span><span class="s2">"-d64 -Xmx4096m -Xms512m -server -ea"</span>
<span class="nv">HEAP_DUMP</span><span class="o">=</span><span class="s2">"-XX:+HeapDumpOnOutOfMemoryError"</span>
<span class="nv">HEADLESS</span><span class="o">=</span><span class="s2">"-Djava.awt.headless=true"</span>

<span class="c">#</span>
<span class="c"># Standard setup.</span>
<span class="c">#</span>
<span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"</span><span class="nv">$CONTENT_ROOT</span><span class="s2"> </span><span class="nv">$NORMAL</span><span class="s2"> </span><span class="nv">$MAX_PERM_GEN</span><span class="s2"> </span><span class="nv">$HEAP_DUMP</span><span class="s2"> </span><span class="nv">$HEADLESS</span><span class="s2"> </span><span class="nv">$JAVA_PREFS_ROOTS</span><span class="s2">"</span>

<span class="nb">export </span>JAVA_OPTS
</code></pre>
    </div>

    <div class="alert alert-warning" role="alert"><i class="fa fa-warning"></i> <b>Important:</b> 
Whenever possible, Unidata recommends -Xmx4096m (or more) for 64-bit systems.
</div>

    <p>The parameters we pass to <code class="highlighter-rouge">$JAVA_OPTS</code>:</p>

    <ul>
      <li><code class="highlighter-rouge">CONTENT_ROOT</code> is TDS specific, and definds the location of where TDS related configuration files will be stored.</li>
      <li><code class="highlighter-rouge">-Xms</code> is the initial and minimum allocated memory of the JVM (for performance).</li>
      <li><code class="highlighter-rouge">-Xmx</code> the maximum allocated memory of the JVM (for performance).</li>
      <li><code class="highlighter-rouge">-server</code> tells the Hostspot compiler to run the JVM in “server” mode (for performance).</li>
      <li><code class="highlighter-rouge">-Djava.awt.headless=true</code> is needed to prevent graphics rendering code from assuming a graphics console exists.
Without this, WMS code will crash the server in some circumstances.</li>
      <li><code class="highlighter-rouge">-Djava.util.prefs.systemRoot=$CATALINA_BASE/content/thredds/javaUtilPrefs</code> allows the java.util.prefs of the TDS WMS to write system preferences to a location that is writable by the Tomcat user.</li>
    </ul>
  </li>
  <li>
    <p>Implement your changes by restarting Tomcat.</p>

    <p>Restart Tomcat and examine the output generated to the terminal window by the startup script:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>./startup.sh
Using CATALINA_BASE:   /usr/local/tds/apache-tomcat-8.0.24
Using CATALINA_HOME:   /usr/local/tds/apache-tomcat-8.0.24
Using CATALINA_TMPDIR: /usr/local/tds/apache-tomcat-8.0.24/temp
Using JRE_HOME: /usr/local/tds/jdk1.8u51
Using CLASSPATH:       /usr/local/tds/apache-tomcat-8.0.24/bin/bootstrap.jar:/usr/local/tds/apache-tomcat-8.0.24/bin/tomcat-juli.jar
</code></pre>
    </div>

    <div class="alert alert-info" role="alert"><i class="fa fa-question-circle"></i> <b>Question:</b> 
Did you notice any difference in the what is being reported to STDOUT during startup?
</div>

    <p>Take a look at the running Tomcat process to see the new <code class="highlighter-rouge">$JAVA_OPTS</code> settings:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ps -ef | grep tomcat
tds      22007     1  9 09:44 pts/1    00:00:02 /usr/local/tds/jdk1.8u51/bin/java -Djava.util.logging.config.file<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/conf/logging.properties -Djava.util.logging.manager<span class="o">=</span>org.apache.juli.ClassLoaderLogManager -Xmx4096m
  -Xms512m -server -Djava.awt.headless<span class="o">=</span><span class="nb">true</span> -Djava.util.prefs.systemRoot<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/content/thredds/javaUtilPrefs -Djava.endorsed.dirs<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/endorsed -classpath /usr/local/tds/apache-tomcat-8.0.24/bin/bootstrap.jar:/usr/local/tds/apache-tomcat-8.0.24/bin/tomcat-juli.jar -Dcatalina.base<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24 -Dcatalina.home<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24 -Djava.io.tmpdir<span class="o">=</span>/usr/local/tds/apache-tomcat-8.0.24/temp org.apache.catalina.startup.Bootstrap start
tds      22030 21675  0 09:44 pts/1    00:00:00 grep tomcat
</code></pre>
    </div>

    <div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> 
For more information on the environment variable prerequisites used by Tomcat, consult ${tomcat_home}/bin/catalina.sh (or catalina.bat) file.</div>

    <div class="alert alert-info" role="alert"><i class="fa fa-question-circle"></i> <b>Question:</b> 
What allows us to create the setenv.sh file and have its contents read? (Hint: have a look at the catalina.sh file in the Tomcat bin/ directory).
</div>
  </li>
</ol>

<h2 id="troubleshooting">Troubleshooting</h2>

<ul>
  <li>Do not forget include the <code class="highlighter-rouge">m</code> in your <code class="highlighter-rouge">-Xms</code> and <code class="highlighter-rouge">-Xmx</code> settings.</li>
  <li>
    <p>You may have allocated too much memory for the JVM settings if Tomcat fails to start and you get the following error reported in the Tomcat log <code class="highlighter-rouge">catalina.out</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>Error occurred during initialization of VM
Could not reserve enough space for object heap
</code></pre>
    </div>
  </li>
  <li>
    <p>Likewise, if there is an error with your JVM memory allocation syntax in the <code class="highlighter-rouge">setenv.sh</code> file, it will be reported to <code class="highlighter-rouge">catalina.out</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>Error occurred during initialization of VM
Incompatible minimum and maximum heap sizes specified
</code></pre>
    </div>
  </li>
  <li>
    <p>If you intend to use WMS and see something like the following in reported in <code class="highlighter-rouge">catalina.out</code>:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>May 25, 2010 6:28:22 PM java.util.prefs.FileSystemPreferences syncWorld
WARNING: Couldn't flush system prefs: java.util.prefs.BackingStoreException: /etc/.java/.systemPrefs/org create failed.
</code></pre>
    </div>

    <p>You will need to set the <code class="highlighter-rouge">java.util.prefs.systemRoot</code> system property in <code class="highlighter-rouge">$JAVA_OPTS</code> to a location that is writable by the user that Tomcat, e.g.:</p>

    <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="c">#</span>
<span class="c"># ENVARS for Tomcat and TDS environment</span>
<span class="c">#</span>
<span class="nv">JAVA_HOME</span><span class="o">=</span><span class="s2">"/usr/local/tds/jdk1.8u51"</span>
<span class="nb">export </span>JAVA_HOME

<span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"-Xmx4096m -Xms512m -server -Djava.awt.headless=true -Djava.util.prefs.systemRoot=</span><span class="nv">$CATALINA_BASE</span><span class="s2">/content/thredds/javaUtilPrefs"</span>
<span class="nb">export </span>JAVA_OPTS

<span class="nv">CATALINA_BASE</span><span class="o">=</span><span class="s2">"/usr/local/tds/apache-tomcat-8.0.24"</span>
<span class="nb">export </span>CATALINA_BASE
</code></pre>
    </div>
  </li>
</ul>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Unidata. All rights reserved. <br />
<span>Page last updated:</span> 2016-09-27<br/> Site last generated: Sep 14, 2017 <br />
<p><img src="http://www.unidata.ucar.edu/images/logo.png" alt="UCAR/Unidata"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-92978945-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>