<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>TDS Web Map Service (WMS) | THREDDS Documentation</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="www.unidata.ucar.edufeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> THREDDS Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">THREDDS Source<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/Unidata/THREDDS" target="_blank">netCDF-Java and TDS Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/Rosetta" target="_blank">Rosetta Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://github.com/Unidata/siphon" target="_blank">Siphon Github Repo</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="tds_tutorial_index.html">THREDDS Data Server Tutorial</a></li>
                        
                        
                        
                        <li><a href="netcdf_java_tutorial_index.html">netCDF-Java Tutorial</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.unidata.ucar.edu/software/rosetta/docs/" target="_blank">Rosetta</a></li>
                        
                        
                        
                        <li><a href="https://siphon.readthedocs.io/en/latest/#" target="_blank">Siphon</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li><a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:support-thredds@unidta.ucar.edu?subject=THREDDS Documentation Feedback f eedback&body=I have some feedback about the TDS Web Map Service (WMS) page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a><li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="TDS Web Map Service (WMS)">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          







<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">TDS Tutorial 5.0.0</li>
    
    
    
        
    
    <li>
        <a href="#">Getting Started with the TDS</a>
        <ul>
            
            
            
            <li><a href="tds_tutorial_index.html">TDS Overview</a></li>
            
            
            
            
            
            
            <li><a href="install_java_tomcat.html">Installing Java and Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_dir_structure_qt.html">Tomcat Directory Structure</a></li>
            
            
            
            
            
            
            <li><a href="running_tomcat.html">Running Tomcat</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_log_files.html">Tomcat Log Files</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_configuration_files.html">Tomcat Config Files</a></li>
            
            
            
            
            
            
            <li><a href="deploying_the_tds.html">Deploying the TDS</a></li>
            
            
            
            
            
            
            <li><a href="tomcat_manager_app.html">Tomcat Manager Application</a></li>
            
            
            
            
            
            
            <li><a href="where_to_go_from_here.html">Where to go from here</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Client Catalogs</a>
        <ul>
            
            
            
            <li><a href="basic_client_catalog.html">Basic Client Catalog Primer</a></li>
            
            
            
            
            
            
            <li><a href="nested_datasets.html">Nested Datasets</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_metadata.html">Client Catalog Metadata</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_references.html">Catalog References</a></li>
            
            
            
            
            
            
            <li><a href="compound_service_elements.html">Compound service elements</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_xml_validation.html">XML Validation</a></li>
            
            
            
            
            
            
            <li><a href="client_catalog_via_toolsUI.html">Client Catalogs in ToolsUI</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">TDS Configuration</a>
        <ul>
            
            
            
            <li><a href="tds_content_directory.html">TDS Content Directory</a></li>
            
            
            
            
            
            
            <li><a href="default_config_catalog.html">Default TDS Configuration Catalog</a></li>
            
            
            
            
            
            
            <li><a href="basic_config_catalog.html">Basics of Configuration Catalogs</a></li>
            
            
            
            
            
            
            <li><a href="basic_tds_configuration.html">Basic TDS Configuration</a></li>
            
            
            
            
            
            
            <li><a href="adding_ogc_iso_services.html">Adding OGC / ISO Services</a></li>
            
            
            
            
            
            
            <li><a href="adding_ncss.html">Adding the netCDF Subset Service</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Monitoring and Debugging</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">TDS Monitoring and Debugging</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Tomcat and TDS Logs</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using the TdsMonitor Tool</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">3rd Party Tools</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">netCDF Markup Language (NcML)</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Basic NcML Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Using NcML in the TDS</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Basic NcML Examples</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">NcML Aggregation Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Feature Collections</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collections</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Feature Collection Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Files in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">GRIB Tables in CDM</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Forecast Model Run Collections (FMRC)</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">FMRC Examples</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Metadata</a>
        <ul>
            
            
            
            <li><a href="under_construction.html">THREDDS Metadata</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">ISO Metadata Generation</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Production Servers</a>
        <ul>
            
            
            
            <li><a href="production_server_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Troubleshooting Problems</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Performance Tips</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Upgrading to 5.0</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Installation Checklist</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">FAQ</a>
        <ul>
            
            
            
            <li><a href="tds_faq.html">FAQ</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Reference Guide</a>
        <ul>
            
            
            
            <li><a href="tds_config_ref.html">TDS Config (threddsConfig.xml)</a></li>
            
            
            
            
            
            
            <li><a href="viewers_ref.html">Viewers</a></li>
            
            
            
            
            
            
            <li><a href="dataset_source_plugin.html">Data Source Plugins</a></li>
            
            
            
            
            
            
            <li><a href="wcs_ref.html">WCS Reference</a></li>
            
            
            
            
            
            
            <li class="active"><a href="wms_ref.html">WMS Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Remote Management Reference</a></li>
            
            
            
            
            
            
            <li><a href="under_construction.html">Netcdf Subset Service Reference</a></li>
            
            
            
            
            
            
            <li><a href="tds_doc_guide.html">netCDF-Java and TDS Doc Guide</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">TDS Web Map Service (WMS)</h1>
</div>



<div class="post-content">

   

    

    

    

    

  <p>The TDS WMS implementation uses the ncWMS software developed by Jon Blower (Reading E-Science Center at the University of Reading).
It supports OGC Web Map Service (WMS) versions 1.3.0 and 1.1.1.</p>

<h2 id="which-files-can-be-served-through-the-wms-server">Which files can be served through the WMS server?</h2>

<p>Data files must contain gridded data.
The NetCDF-Java Common Data Model must be able to identify the coordinates system used. Check this by opening in the Grid Panel of the ToolsUI application.
There should be one or more variables shown as a GeoGrid.</p>

<h2 id="enabling-and-using-wms">Enabling and Using WMS</h2>

<p>By default the WMS service is enabled in the TDS.</p>

<p>As long as the WMS service is enabled, datasets can be configured to have a WMS access method in the TDS catalog configuration files similar to how other services are configured.
The service element’s serviceType and base attribute values must be as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;service name="wms" serviceType="WMS" base="/thredds/wms/" /&gt;
</code></pre>
</div>

<p>The dataset to be served must reference this service (or a containing compound service) by the service name:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;dataset ID="sample" name="Sample Data" urlPath="sample.nc"&gt;
  &lt;serviceName&gt;wms&lt;/serviceName&gt;
&lt;/dataset&gt;
</code></pre>
</div>

<p>WMS clients may not be able to directly use the THREDDS catalogs to find the WMS services but the catalogs are useful for users to browse and for separate search services (e.g., OGC catalog services).</p>

<h2 id="wms-configuration">WMS Configuration</h2>

<p>Additional WMS configuration options can be set in the threddsConfig.xml file. More details on these options are available <a href="#wms-service">here</a>.</p>

<p>Further WMS configuration properties are set in the wmsConfig.xml file.
These properties are mainly related with styling of WMS images.
Similar to the threddsConfig.xml file, the WMS configuration file (wmsConfig.xml) is found in the <code class="highlighter-rouge">$tds.content.root.path{}/content/thredds</code> directory.
A detailed description of the wmsConfig.xml file can be found at the MyOcean “Detailed WMS Configuration” page.</p>

<p>If you are installing a new TDS, you should find a default wmsConfig.xml file (along with other configuration files) in your content/thredds directory after you first deploy the TDS.
If you are upgrading from a TDS version before version <code class="highlighter-rouge">4.2.20100615.*</code>, you will have to copy the default file from <code class="highlighter-rouge">${tomcat_home}/webapps/thredds/WEB-INF/altContent/startup/wmsConfig.xml</code>.</p>

<h2 id="change-to-crs-list-in-wms-getcapabilities-documents">Change to CRS List in WMS GetCapabilities Documents</h2>

<p>The number of CRS listed in the WMS GetCapabilities documents has been reduced between TDS 4.1 and 4.2. More information is available at this FAQ entry.</p>

<h2 id="add-a-jvm-option-to-avoid-an-x-server-bug">Add a JVM Option to Avoid an X Server Bug</h2>

<p>WMS uses a number of graphics packages.
In some situations, WMS can run into an X Server bug that can cause Tomcat to crash.
This can be avoided by telling the code there is no display device. You may see error messages like the following:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">NoClassDefFoundError</span><span class="o">:</span> <span class="n">Could</span> <span class="n">not</span> <span class="n">initialize</span> <span class="kd">class</span> <span class="nc">sun</span><span class="o">.</span><span class="na">awt</span><span class="o">.</span><span class="na">X11GraphicsEnvironment</span>
</code></pre>
</div>

<p>To avoid this situation, the graphics code needs to be told that there is no graphics console available.
This can be done by setting the <code class="highlighter-rouge">java.awt.headless</code> system property to <code class="highlighter-rouge">true</code> which can be done using <code class="highlighter-rouge">JAVA_OPTS</code>:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"-Xmx1024m -Xms256m -server -Djava.awt.headless=true"</span>
<span class="nb">export </span>JAVA_OPT
</code></pre>
</div>

<p>What the option means:</p>

<p><code class="highlighter-rouge">-Djava.awt.headless=true</code> sets the value of the <code class="highlighter-rouge">java.awt.headless</code> system property to <code class="highlighter-rouge">true</code>.
Setting this system property to true prevent graphics rendering code from assuming that a graphics console exists.
More on using the headless mode in Java SE here.</p>

<h2 id="add-a-jvm-option-to-avoid-javautilprefs-problem-storing-system-preferences">Add a JVM Option to Avoid <code class="highlighter-rouge">java.util.prefs</code> Problem Storing System Preferences</h2>

<p>Some libraries that WMS depends on use the <code class="highlighter-rouge">java.util.prefs</code> package and there are some known issues that can crop up with storing system preferences.
This problem can be avoided by setting the <code class="highlighter-rouge">java.util.prefs.systemRoot</code> system property to point to a directory in which the TDS can write.
The given directory must exist and must contain a directory named “.systemPrefs” which must be writable by the user under which Tomcat is run.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"-Xmx1024m -Xms256m -server -Djava.util.prefs.systemRoot=</span><span class="nv">$CATALINA_HOME</span><span class="s2">/content/thredds/javaUtilPrefs"</span>
<span class="nb">export </span>JAVA_OPT
</code></pre>
</div>

<p>What the option means:</p>

<p><code class="highlighter-rouge">-Djava.util.prefs.systemRoot=&lt;directory&gt;</code> sets the value of the <code class="highlighter-rouge">java.util.prefs.systemRoot</code> system property to the given directory path.
The <code class="highlighter-rouge">java.util.prefs</code> code will use the given directory to persist the system (as opposed to user) preferences.
More information on the issue can be found on the TDS FAQ page.</p>

<h2 id="serving-remote-datasets">Serving Remote Datasets</h2>

<p>The TDS can also serve remote datasets with the WMS protocol if configured to do so.
It must be explicitly configured in the threddsConfig.xml configuration file. This is done by adding an allowRemote element to the WMS element as follows:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;WMS&gt;</span>
  <span class="nt">&lt;allow&gt;</span>true<span class="nt">&lt;/allow&gt;</span>
  <span class="nt">&lt;allowRemote&gt;</span>true<span class="nt">&lt;/allowRemote&gt;</span>
  ...
<span class="nt">&lt;/WMS&gt;</span>
</code></pre>
</div>

<p>A slight extension of the WMS Dataset URL format allows the TDS to serve remote datasets.
The dataset is identified by adding the parameter dataset whose value is a URL:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>http://servername:8080/thredds/wms?dataset=datasetURL
</code></pre>
</div>

<p>The URL must be a dataset readable by the NetCDF-Java library, typically an OPeNDAP dataset on another server.
It must have gridded data with identifiable coordinate systems (see above).
For example, an OPeNDAP URL might be</p>

<div class="highlighter-rouge"><pre class="highlight"><code>http://las.pfeg.noaa.gov/cgi-bin/nph-dods/data/oceanwatch/nrt/gac/AG14day.nc
</code></pre>
</div>

<p>This can be served remotely as a WMS dataset with this URL:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>http://servername:8080/thredds/wms?dataset=http://las.pfeg.noaa.gov/cgi-bin/nph-dods/data/oceanwatch/nrt/gac/AG14day.nc
</code></pre>
</div>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Unidata. All rights reserved. <br />
<span>Page last updated:</span> 2017-01-18<br/> Site last generated: Sep 14, 2017 <br />
<p><img src="http://www.unidata.ucar.edu/images/logo.png" alt="UCAR/Unidata"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-92978945-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>